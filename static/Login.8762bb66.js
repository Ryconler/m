var I=(u,s,a)=>new Promise((i,B)=>{var r=l=>{try{v(a.next(l))}catch(n){B(n)}},c=l=>{try{v(a.throw(l))}catch(n){B(n)}},v=l=>l.done?i(l.value):Promise.resolve(l.value).then(r,c);v((a=a.apply(u,s)).next())});import{c as q,z as W,R as K,S as y,n as O,d as V,U as j,V as Y,h as g,W as G,p as L,X as H,C as M,b as J,Y as X,g as Z,t as U,D as Q,_ as ee,r as C,K as te,G as P,H as x,Z as ue,$ as ne,I as oe,a0 as k,a1 as _,J as $,a2 as T,F as ae,a3 as w,a4 as N,a5 as le,a6 as se}from"./index.b2407a93.js";import{l as R}from"./storage.f0e80fa9.js";import{S as z}from"./storage.2d44022f.js";import{u as ie}from"./urlPrefixes.2e917cec.js";const[re,b]=q("button"),ce=W({},K,{tag:y("button"),text:String,icon:String,type:y("default"),size:y("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:y("button"),loadingSize:O,loadingText:String,loadingType:String,iconPosition:y("left")});var de=V({name:re,props:ce,emits:["click"],setup(u,{emit:s,slots:a}){const i=j(),B=()=>a.loading?a.loading():g(H,{size:u.loadingSize,type:u.loadingType,class:b("loading")},null),r=()=>{if(u.loading)return B();if(a.icon)return g("div",{class:b("icon")},[a.icon()]);if(u.icon)return g(G,{name:u.icon,class:b("icon"),classPrefix:u.iconPrefix},null)},c=()=>{let n;if(u.loading?n=u.loadingText:n=a.default?a.default():u.text,n)return g("span",{class:b("text")},[n])},v=()=>{const{color:n,plain:h}=u;if(n){const d={color:h?n:"white"};return h||(d.background=n),n.includes("gradient")?d.border=0:d.borderColor=n,d}},l=n=>{u.loading?L(n):u.disabled||(s("click",n),i())};return()=>{const{tag:n,type:h,size:d,block:p,round:F,plain:E,square:e,loading:t,disabled:o,hairline:m,nativeType:f,iconPosition:S}=u,A=[b([h,d,{plain:E,block:p,round:F,square:e,loading:t,disabled:o,hairline:m}]),{[Y]:m}];return g(n,{type:f,class:A,style:v(),disabled:o,onClick:l},{default:()=>[g("div",{class:b("content")},[S==="left"&&r(),c(),S==="right"&&r()])]})}}});const fe=M(de),[me,ge]=q("form"),Be={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:O,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:U,showErrorMessage:U,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var ve=V({name:me,props:Be,emits:["submit","failed"],setup(u,{emit:s,slots:a}){const{children:i,linkChildren:B}=J(X),r=e=>e?i.filter(t=>e.includes(t.name)):i,c=e=>new Promise((t,o)=>{const m=[];r(e).reduce((S,A)=>S.then(()=>{if(!m.length)return A.validate().then(D=>{D&&m.push(D)})}),Promise.resolve()).then(()=>{m.length?o(m):t()})}),v=e=>new Promise((t,o)=>{const m=r(e);Promise.all(m.map(f=>f.validate())).then(f=>{f=f.filter(Boolean),f.length?o(f):t()})}),l=e=>{const t=i.find(o=>o.name===e);return t?new Promise((o,m)=>{t.validate().then(f=>{f?m(f):o()})}):Promise.reject()},n=e=>typeof e=="string"?l(e):u.validateFirst?c(e):v(e),h=e=>{typeof e=="string"&&(e=[e]),r(e).forEach(o=>{o.resetValidation()})},d=(e,t)=>{i.some(o=>o.name===e?(o.$el.scrollIntoView(t),!0):!1)},p=()=>i.reduce((e,t)=>(e[t.name]=t.formValue.value,e),{}),F=()=>{const e=p();n().then(()=>s("submit",e)).catch(t=>{s("failed",{values:e,errors:t}),u.scrollToError&&t[0].name&&d(t[0].name)})},E=e=>{L(e),F()};return B({props:u}),Z({submit:F,validate:n,getValues:p,scrollToField:d,resetValidation:h}),()=>{var e;return g("form",{class:ge(),onSubmit:E},[(e=a.default)==null?void 0:e.call(a)])}}});const he=M(ve);const Ce={checkUserExist:`${ie.cloudbaseApi}/checkUserExist`};function pe(u){return I(this,null,function*(){try{const s=yield Q.get(`${Ce.checkUserExist}?phoneNumber=${u}`),{code:a}=s;return a=="1"}catch(s){return!1}})}const Fe=u=>(ue("data-v-7f1f419c"),u=u(),ne(),u),be={class:"login"},Ee=Fe(()=>w("h1",{class:"pf-medium"},"\u5FEB\u6377\u767B\u5F55",-1)),ye={style:{margin:"16px"}},xe=V({setup(u){const s=C(""),a=C(/^1[0-9]{10}$/),i=C(""),B=C(""),r=C("\u83B7\u53D6\u9A8C\u8BC1\u7801"),c=C("\u767B\u5F55"),v=e=>{e.length==11&&pe(e).then(t=>{t?c.value="\u767B\u5F55":c.value="\u6CE8\u518C"})};let l=R.getItem(z.SendTime);const n=Date.now();if(l){let e=n-l;e<60*1e3&&h(Math.floor(e/1e3))}function h(e){r.value=`${e}s`;const t=setInterval(()=>{r.value=`${--e}s`,e<=0&&(clearInterval(t),r.value="\u83B7\u53D6\u9A8C\u8BC1\u7801")},1e3)}const d=C(null),p=()=>{r.value=="\u83B7\u53D6\u9A8C\u8BC1\u7801"&&d.value&&d.value.validate("\u624B\u673A\u53F7").then(()=>{l=Date.now(),R.setItem(z.SendTime,l),h(60),k.sendPhoneCode(s.value)})},F=oe(),E=()=>{function e(){const t=F.query.referrer||document.referrer||"//m.wzmxx.com";location.href=decodeURIComponent(t.toString())}c.value=="\u767B\u5F55"?k.signInWithPhoneCodeOrPassword({phoneNumber:s.value,password:i.value}).then(()=>{_("\u767B\u5F55\u6210\u529F"),setTimeout(()=>{e()},1e3)}).catch(()=>{_(`\u767B\u5F55\u5931\u8D25
\u8BF7\u68C0\u67E5\u624B\u673A\u53F7/\u5BC6\u7801\u662F\u5426\u586B\u5199\u6B63\u786E`)}):c.value=="\u6CE8\u518C"&&k.signUpWithPhoneCode(s.value,B.value,i.value).then(()=>{_("\u6CE8\u518C\u6210\u529F"),setTimeout(()=>{e()},1e3)}).catch(()=>{_(`\u6CE8\u518C\u5931\u8D25
\u8BF7\u68C0\u67E5\u77ED\u4FE1\u9A8C\u8BC1\u7801\u662F\u5426\u586B\u5199\u6B63\u786E`)})};return(e,t)=>($(),te("div",be,[Ee,g(x(he),{ref_key:"loginForm",ref:d,onSubmit:E},{default:P(()=>[g(x(T),{modelValue:s.value,"onUpdate:modelValue":[t[0]||(t[0]=o=>s.value=o),v],name:"\u624B\u673A\u53F7",type:"tel",label:"\u624B\u673A\u53F7",placeholder:"\u672A\u6CE8\u518C\u8FC7\u624B\u673A\u53F7\u5C06\u81EA\u52A8\u6CE8\u518C",rules:[{pattern:a.value,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]},null,8,["modelValue","rules"]),g(x(T),{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value=o),type:"password",name:"\u5BC6\u7801",label:"\u5BC6\u7801",placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801"}]},null,8,["modelValue"]),c.value=="\u6CE8\u518C"?($(),ae(x(T),{key:0,modelValue:B.value,"onUpdate:modelValue":t[2]||(t[2]=o=>B.value=o),name:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",label:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",placeholder:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u77ED\u4FE1\u9A8C\u8BC1\u7801"}]},{button:P(()=>[w("div",{class:"send-btn",onClick:p},N(r.value),1)]),_:1},8,["modelValue"])):le("",!0),w("div",ye,[g(x(fe),{class:"submit-btn",round:"",block:"",type:"primary","native-type":"submit",color:c.value=="\u6CE8\u518C"?"#ff5900":""},{default:P(()=>[se(N(c.value),1)]),_:1},8,["color"])])]),_:1},512)]))}});var Te=ee(xe,[["__scopeId","data-v-7f1f419c"]]);export{Te as default};
//# sourceMappingURL=Login.8762bb66.js.map
