var I=(u,s,o)=>new Promise((i,B)=>{var r=l=>{try{v(o.next(l))}catch(n){B(n)}},c=l=>{try{v(o.throw(l))}catch(n){B(n)}},v=l=>l.done?i(l.value):Promise.resolve(l.value).then(r,c);v((o=o.apply(u,s)).next())});import{c as q,z as W,U as K,V as y,n as L,d as V,W as j,X as Y,h as g,Y as G,p as O,Z as H,C as M,t as U,b as J,$ as X,g as Z,D as Q,E as ee,_ as te,r as C,L as ue,H as P,I as x,a0 as ne,a1 as ae,J as oe,a2 as k,a3 as S,K as $,a4 as T,G as le,a5 as w,a6 as N,a7 as se,a8 as ie}from"./index.8eff2da7.js";import{l as R}from"./storage.f0e80fa9.js";import{S as z}from"./storage.ab874d93.js";const[re,E]=q("button"),ce=W({},K,{tag:y("button"),text:String,icon:String,type:y("default"),size:y("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:y("button"),loadingSize:L,loadingText:String,loadingType:String,iconPosition:y("left")});var de=V({name:re,props:ce,emits:["click"],setup(u,{emit:s,slots:o}){const i=j(),B=()=>o.loading?o.loading():g(H,{size:u.loadingSize,type:u.loadingType,class:E("loading")},null),r=()=>{if(u.loading)return B();if(o.icon)return g("div",{class:E("icon")},[o.icon()]);if(u.icon)return g(G,{name:u.icon,class:E("icon"),classPrefix:u.iconPrefix},null)},c=()=>{let n;if(u.loading?n=u.loadingText:n=o.default?o.default():u.text,n)return g("span",{class:E("text")},[n])},v=()=>{const{color:n,plain:h}=u;if(n){const d={color:h?n:"white"};return h||(d.background=n),n.includes("gradient")?d.border=0:d.borderColor=n,d}},l=n=>{u.loading?O(n):u.disabled||(s("click",n),i())};return()=>{const{tag:n,type:h,size:d,block:p,round:b,plain:F,square:e,loading:t,disabled:a,hairline:m,nativeType:f,iconPosition:_}=u,A=[E([h,d,{plain:F,block:p,round:b,square:e,loading:t,disabled:a,hairline:m}]),{[Y]:m}];return g(n,{type:f,class:A,style:v(),disabled:a,onClick:l},{default:()=>[g("div",{class:E("content")},[_==="left"&&r(),c(),_==="right"&&r()])]})}}});const fe=M(de),[me,ge]=q("form"),Be={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:L,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:U,showErrorMessage:U,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var ve=V({name:me,props:Be,emits:["submit","failed"],setup(u,{emit:s,slots:o}){const{children:i,linkChildren:B}=J(X),r=e=>e?i.filter(t=>e.includes(t.name)):i,c=e=>new Promise((t,a)=>{const m=[];r(e).reduce((_,A)=>_.then(()=>{if(!m.length)return A.validate().then(D=>{D&&m.push(D)})}),Promise.resolve()).then(()=>{m.length?a(m):t()})}),v=e=>new Promise((t,a)=>{const m=r(e);Promise.all(m.map(f=>f.validate())).then(f=>{f=f.filter(Boolean),f.length?a(f):t()})}),l=e=>{const t=i.find(a=>a.name===e);return t?new Promise((a,m)=>{t.validate().then(f=>{f?m(f):a()})}):Promise.reject()},n=e=>typeof e=="string"?l(e):u.validateFirst?c(e):v(e),h=e=>{typeof e=="string"&&(e=[e]),r(e).forEach(a=>{a.resetValidation()})},d=(e,t)=>{i.some(a=>a.name===e?(a.$el.scrollIntoView(t),!0):!1)},p=()=>i.reduce((e,t)=>(e[t.name]=t.formValue.value,e),{}),b=()=>{const e=p();n().then(()=>s("submit",e)).catch(t=>{s("failed",{values:e,errors:t}),u.scrollToError&&t[0].name&&d(t[0].name)})},F=e=>{O(e),b()};return B({props:u}),Z({submit:b,validate:n,getValues:p,scrollToField:d,resetValidation:h}),()=>{var e;return g("form",{class:ge(),onSubmit:F},[(e=o.default)==null?void 0:e.call(o)])}}});const he=M(ve);const Ce={checkUserExist:`${ee.cloudbaseApi}/checkUserExist`};function pe(u){return I(this,null,function*(){try{const s=yield Q.get(`${Ce.checkUserExist}?phoneNumber=${u}`),{code:o}=s;return o=="1"}catch(s){return!1}})}const be=u=>(ne("data-v-7f1f419c"),u=u(),ae(),u),Ee={class:"login"},Fe=be(()=>w("h1",{class:"pf-medium"},"\u5FEB\u6377\u767B\u5F55",-1)),ye={style:{margin:"16px"}},xe=V({setup(u){const s=C(""),o=C(/^1[0-9]{10}$/),i=C(""),B=C(""),r=C("\u83B7\u53D6\u9A8C\u8BC1\u7801"),c=C("\u767B\u5F55"),v=e=>{e.length==11&&pe(e).then(t=>{t?c.value="\u767B\u5F55":c.value="\u6CE8\u518C"})};let l=R.getItem(z.SendTime);const n=Date.now();if(l){let e=n-l;e<60*1e3&&h(Math.floor(e/1e3))}function h(e){r.value=`${e}s`;const t=setInterval(()=>{r.value=`${--e}s`,e<=0&&(clearInterval(t),r.value="\u83B7\u53D6\u9A8C\u8BC1\u7801")},1e3)}const d=C(null),p=()=>{r.value=="\u83B7\u53D6\u9A8C\u8BC1\u7801"&&d.value&&d.value.validate("\u624B\u673A\u53F7").then(()=>{l=Date.now(),R.setItem(z.SendTime,l),h(60),k.sendPhoneCode(s.value)})},b=oe(),F=()=>{function e(){const t=b.query.referrer||document.referrer||"//m.wzmxx.com";location.href=decodeURIComponent(t.toString())}c.value=="\u767B\u5F55"?k.signInWithPhoneCodeOrPassword({phoneNumber:s.value,password:i.value}).then(()=>{S("\u767B\u5F55\u6210\u529F"),setTimeout(()=>{e()},1e3)}).catch(()=>{S(`\u767B\u5F55\u5931\u8D25
\u8BF7\u68C0\u67E5\u624B\u673A\u53F7/\u5BC6\u7801\u662F\u5426\u586B\u5199\u6B63\u786E`)}):c.value=="\u6CE8\u518C"&&k.signUpWithPhoneCode(s.value,B.value,i.value).then(()=>{S("\u6CE8\u518C\u6210\u529F"),setTimeout(()=>{e()},1e3)}).catch(()=>{S(`\u6CE8\u518C\u5931\u8D25
\u8BF7\u68C0\u67E5\u77ED\u4FE1\u9A8C\u8BC1\u7801\u662F\u5426\u586B\u5199\u6B63\u786E`)})};return(e,t)=>($(),ue("div",Ee,[Fe,g(x(he),{ref_key:"loginForm",ref:d,onSubmit:F},{default:P(()=>[g(x(T),{modelValue:s.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>s.value=a),v],name:"\u624B\u673A\u53F7",type:"tel",label:"\u624B\u673A\u53F7",placeholder:"\u672A\u6CE8\u518C\u8FC7\u624B\u673A\u53F7\u5C06\u81EA\u52A8\u6CE8\u518C",rules:[{pattern:o.value,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]},null,8,["modelValue","rules"]),g(x(T),{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value=a),type:"password",name:"\u5BC6\u7801",label:"\u5BC6\u7801",placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801"}]},null,8,["modelValue"]),c.value=="\u6CE8\u518C"?($(),le(x(T),{key:0,modelValue:B.value,"onUpdate:modelValue":t[2]||(t[2]=a=>B.value=a),name:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",label:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",placeholder:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u77ED\u4FE1\u9A8C\u8BC1\u7801"}]},{button:P(()=>[w("div",{class:"send-btn",onClick:p},N(r.value),1)]),_:1},8,["modelValue"])):se("",!0),w("div",ye,[g(x(fe),{class:"submit-btn",round:"",block:"",type:"primary","native-type":"submit",color:c.value=="\u6CE8\u518C"?"#ff5900":""},{default:P(()=>[ie(N(c.value),1)]),_:1},8,["color"])])]),_:1},512)]))}});var ke=te(xe,[["__scopeId","data-v-7f1f419c"]]);export{ke as default};
//# sourceMappingURL=Login.9386faae.js.map
