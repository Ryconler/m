var ke=Object.defineProperty,Ie=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var ce=(t,n,s)=>n in t?ke(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,W=(t,n)=>{for(var s in n||(n={}))Ae.call(n,s)&&ce(t,s,n[s]);if(ue)for(var s of ue(n))Ee.call(n,s)&&ce(t,s,n[s]);return t},X=(t,n)=>Ie(t,xe(n));var w=(t,n,s)=>new Promise((o,i)=>{var f=a=>{try{d(s.next(a))}catch(h){i(h)}},_=a=>{try{d(s.throw(a))}catch(h){i(h)}},d=a=>a.done?o(a.value):Promise.resolve(a.value).then(f,_);d((s=s.apply(t,n)).next())});import{c as Fe,d as U,r as C,a as De,w as de,aP as be,o as re,g as Be,f as $e,h as S,ao as we,V as Te,t as Le,j as Q,q as fe,k as Oe,Z as Re,C as Pe,_ as V,Q as G,ad as M,K as l,L as y,a5 as p,N as D,M as O,G as x,I as e,a0 as ie,a1 as ne,e as T,aQ as Ne,F as Ue,a3 as q,aR as me,aS as he,R as L,a6 as A,a8 as Y,aT as J,a7 as b,aU as Ve,x as K,aV as P,aW as je,H as B,aX as Z,aY as ee,aZ as qe,a_ as pe,ac as Me,ab as He}from"./index.8eff2da7.js";import{u as Ye}from"./index.bd91264b.js";import{S as Ze}from"./ShareServiceTaskItem.2fa23e14.js";import{u as ze,T as te,a as Ge}from"./index.a19928c9.js";import{I as ye}from"./index.08a7cbc0.js";import{q as oe,a as We,b as Xe,c as Je,d as Qe}from"./shareService.e67b80a6.js";import"./position.4bbb72b2.js";import"./storage.ab874d93.js";import"./storage.f0e80fa9.js";import"./city.452f4acf.js";const[Ke,H,et]=Fe("list"),tt={error:Boolean,offset:we(300),loading:Boolean,finished:Boolean,errorText:String,direction:Te("down"),loadingText:String,finishedText:String,immediateCheck:Le};var st=U({name:Ke,props:tt,emits:["load","update:error","update:loading"],setup(t,{emit:n,slots:s}){const o=C(!1),i=C(),f=C(),_=ze(),d=De(i),a=()=>{Q(()=>{if(o.value||t.finished||t.error||(_==null?void 0:_.value)===!1)return;const{offset:r,direction:g}=t,m=fe(d);if(!m.height||Oe(i))return;let E=!1;const I=fe(f);g==="up"?E=m.top-I.top<=r:E=I.bottom-m.bottom<=r,E&&(o.value=!0,n("update:loading",!0),n("load"))})},h=()=>{if(t.finished){const r=s.finished?s.finished():t.finishedText;if(r)return S("div",{class:H("finished-text")},[r])}},v=()=>{n("update:error",!1),a()},k=()=>{if(t.error){const r=s.error?s.error():t.errorText;if(r)return S("div",{role:"button",class:H("error-text"),tabindex:0,onClick:v},[r])}},c=()=>{if(o.value&&!t.finished)return S("div",{class:H("loading")},[s.loading?s.loading():S(Re,{class:H("loading-icon")},{default:()=>[t.loadingText||et("loading")]})])};return de(()=>[t.loading,t.finished,t.error],a),_&&de(_,r=>{r&&a()}),be(()=>{o.value=t.loading}),re(()=>{t.immediateCheck&&a()}),Be({check:a}),$e("scroll",a,{target:d}),()=>{var r;const g=(r=s.default)==null?void 0:r.call(s),m=S("div",{ref:f,class:H("placeholder")},null);return S("div",{ref:i,role:"feed",class:H(),"aria-busy":o.value},[t.direction==="down"?g:m,c(),h(),k(),t.direction==="up"?g:m])}}});const se=Pe(st);const ve=t=>(ie("data-v-28c1cf49"),t=t(),ne(),t),at={class:"share-service-task"},it=ve(()=>p("i",null,null,-1)),nt=ve(()=>p("div",{class:"title-text pf-medium"},"\u4ECA\u65E5\u5206\u4EAB\u6D3B\u52A8",-1)),rt={class:"task-list"},ot=U({props:{cityInfo:{type:Object,default(){return G}},tasks:{type:Array,default(){return[]}}},setup(t){const n=t,{cityInfo:s,tasks:o}=M(n),i=()=>{location.href=`/share-service/task-list?cityId=${s.value.cityId}`};return(f,_)=>(l(),y("div",at,[p("div",{class:"title"},[it,nt,p("div",{class:"more",onClick:i})]),p("div",rt,[(l(!0),y(D,null,O(e(o).slice(0,4),(d,a)=>(l(),x(Ze,{key:a,class:"task-item",task:d,slices:void 0,"city-id":e(s).cityId},null,8,["task","city-id"]))),128))])]))}});var lt=V(ot,[["__scopeId","data-v-28c1cf49"]]);const ut=(t,n)=>{const s=T(()=>"/xbuy-event/1"),o=T(()=>{const f=+t.value.saleNum;return f>=1e4?Ne(f,1e4)+"\u4E07":Ue.exports.isNumber(f)?f:0});return{spuLink:s,spuSaleNum:o,spuInfoClick:()=>w(void 0,null,function*(){location.href=s.value})}},ct=(t,n,s)=>({spuShareClick:i=>w(void 0,null,function*(){i.preventDefault(),i.stopPropagation(),q.loading({forbidClick:!0,duration:0,message:"\u52A0\u8F7D\u4E2D..."});const f=(yield me(t.value.cmmdtyImage,t.value.minPrice))||t.value.cmmdtyImage||"";q("\u6A21\u62DF\u62C9\u8D77\u539F\u751F\u5206\u4EAB\u9762\u677F\u6210\u529F"),yield he(1500),ye([f])})});const dt=t=>(ie("data-v-0454845a"),t=t(),ne(),t),ft={class:"spu-detail"},pt={class:"spu-name pf-medium"},mt={class:"spu-function"},ht={class:"spu-money"},yt={key:0,class:"spu-earn"},vt=Y(" \u8D5A"),_t=dt(()=>p("i",null,null,-1)),gt=Y("\u5206\u4EAB "),St=[_t,gt],Ct={class:"spu-store"},kt={class:"spu-store-name"},It={key:0,class:"spu-sale-num"},xt={key:0,class:"recommend-icon"},At=U({props:{spu:{type:Object,default(){return{}}},realSpuId:{type:Number,default:null},minShareAmount:{type:Number,default:0},maxShareAmount:{type:Number,default:0},recommended:{type:Boolean,default:!1},shareCityCode:{type:String,default:""}},emits:["inView"],setup(t,{emit:n}){const s=t,{spu:o,realSpuId:i,shareCityCode:f}=M(s),{spuSaleNum:_,spuInfoClick:d}=ut(o),{spuShareClick:a}=ct(o),h=C(null),v=C();return re(()=>w(this,null,function*(){IntersectionObserver&&v.value?(h.value=new IntersectionObserver(k=>{var c;k[0].intersectionRatio<=0||(n("inView"),(c=h.value)==null||c.unobserve(v.value))}),h.value.observe(v.value)):n("inView")})),(k,c)=>{const r=L("BaseImg"),g=L("ProductPrice3");return l(),y("div",{ref_key:"shareSpu",ref:v,class:"share-spu"},[p("div",{class:"spu-info",onClick:c[1]||(c[1]=(...m)=>e(d)&&e(d)(...m))},[S(r,{class:"spu-image",src:e(o).cmmdtyImage,width:186,height:140},null,8,["src"]),p("div",ft,[p("div",pt,A(e(o).spuName),1),p("div",mt,[p("div",ht,[S(g,{class:"spu-price",price:e(o).minPrice,"max-price":e(o).maxPrice},null,8,["price","max-price"]),t.maxShareAmount>0?(l(),y("div",yt,[vt,t.minShareAmount==t.maxShareAmount?(l(),y(D,{key:0},[Y("\xA5"+A(e(J)(t.minShareAmount)),1)],64)):(l(),y(D,{key:1},[Y("\xA5"+A(e(J)(t.minShareAmount))+"-\xA5"+A(e(J)(t.maxShareAmount)),1)],64))])):b("",!0)]),p("div",{class:Ve(["spu-share",e(o).materialFlag&&"has-material"]),onClick:c[0]||(c[0]=(...m)=>e(a)&&e(a)(...m))},St,2)]),p("div",Ct,[p("div",kt,A(e(o).storeName),1),e(_)?(l(),y("div",It,"\u5DF2\u552E"+A(e(_)),1)):b("",!0)])]),t.recommended?(l(),y("div",xt)):b("",!0)])],512)}}});var z=V(At,[["__scopeId","data-v-0454845a"]]);const Et=(t,n,s,o)=>{const i=K({list:[],loading:!1,error:!1,finished:!1,start:0,load:()=>w(void 0,null,function*(){let r;t.value&&(r=`${t.value.lat},${t.value.lng}`);const g=!h.value;try{const m=yield oe(X(W({},a.value),{shareReq:1,isShowHideSpu:1,cityId:n.value.cityId,start:i.start,tabs:"3",type:3,openOption:g,longLatitude:r}));if(g&&(f.value=m.categoryInfo),m.cmmdtyInfo){const E=m.cmmdtyInfo.list||[];i.list.push(...E),i.start+=E.length,i.list.length==m.cmmdtyInfo.total&&(i.finished=!0)}yield Q(),i.loading=!1}catch(m){i.loading=!1,i.error=!0}}),itemInView:(r=!1)=>{}}),f=C([]),_=T(()=>[P.Category,P.District,P.Earn,P.Sale]),d=C({shareGoodsOnly:1,shareAmountSort:!0}),a=C(d.value),h=T(()=>!!(s.value&&(!s.value.allCategoryInfos[0].list[0].selected||!s.value.allDistricts[0].selected))),v=T(()=>o.value.filter(r=>r.maxSaleRate>0));return{spuList:i,categoryInfo:f,filterOptions:_,filterInitData:d,filterIsClassify:h,recommendSpus:v,filterChange:r=>{a.value=r,i.list=[],i.loading=!0,i.error=!1,i.finished=!1,i.start=0,i.load()},filterReset:()=>{s.value&&s.value.reset()}}},ae=()=>{const t=T(()=>je(1.12)),n=T(()=>{const s=document.querySelector(".share-service-task-comp"),o=document.querySelector(".share-service-banner"),i=document.querySelector(".title-bar"),f=s?s.getBoundingClientRect().height:0,_=o?o.getBoundingClientRect().height:0,d=i?i.getBoundingClientRect().height:0;return f+_+d});return{classifySortOffsetTop:t,classifySortStickyDistance:n}};const Ft={class:"spu-list"},Dt=U({props:{position:{type:Object,default(){return null}},cityInfo:{type:Object,default(){return G}},districts:{type:Array,default(){return[]}},allRecommendSpus:{type:Array,default(){return[]}}},setup(t){const n=t,{position:s,cityInfo:o,allRecommendSpus:i}=M(n),{classifySortOffsetTop:f,classifySortStickyDistance:_}=ae(),d=C(),{spuList:a,categoryInfo:h,filterOptions:v,filterInitData:k,filterIsClassify:c,recommendSpus:r,filterChange:g,filterReset:m}=Et(s,o,d,i);return(E,I)=>{const N=L("ClassifySort"),j=L("EmptyError");return l(),x(e(te),{title:"\u5B55\u4EA7",name:"yunchan",style:ee(`min-height: calc(100vh - ${Number(e(f))-1}px)`)},{default:B(()=>[S(N,{ref_key:"classifySort",ref:d,immediate:"",options:e(v),"initial-filter":e(k),"category-infos":e(h),districts:t.districts,"sticky-distance":e(_),"offset-top":e(f),onFilterChange:e(g)},null,8,["options","initial-filter","category-infos","districts","sticky-distance","offset-top","onFilterChange"]),!e(a).loading&&[...e(r),...e(a).list].length==0?(l(),x(j,{key:0,type:e(a).error?"error":"empty",text:e(a).error?"\u52A0\u8F7D\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5":e(c)?"\u6CA1\u6709\u627E\u5230\u7B5B\u9009\u5185\u5BB9\u5462\uFF5E":"\u6CA1\u6709\u627E\u5230\u5185\u5BB9\u5462\uFF5E"},{default:B(()=>[!e(a).error&&e(c)?(l(),y("div",{key:0,class:"reset-classify",onClick:I[0]||(I[0]=(...u)=>e(m)&&e(m)(...u))}," \u91CD\u7F6E\u7B5B\u9009\u9879 ")):b("",!0)]),_:1},8,["type","text"])):b("",!0),p("div",Ft,[(l(!0),y(D,null,O(e(r),(u,F)=>(l(),x(z,{key:F,class:"spu-item",spu:u,"real-spu-id":u.spuId,"min-share-amount":u.minSaleRate,"max-share-amount":u.maxSaleRate,recommended:""},null,8,["spu","real-spu-id","min-share-amount","max-share-amount"]))),128))]),S(e(se),{loading:e(a).loading,"onUpdate:loading":I[1]||(I[1]=u=>e(a).loading=u),error:e(a).error,"onUpdate:error":I[2]||(I[2]=u=>e(a).error=u),class:"spu-list",finished:e(a).finished,"finished-text":[...e(r),...e(a).list].length>0?"\u6CA1\u6709\u66F4\u591A\u4E86":"","immediate-check":!1,onLoad:e(a).load},{default:B(()=>[(l(!0),y(D,null,O(e(a).list,(u,F)=>(l(),x(z,{key:F,class:"spu-item",spu:u,"real-spu-id":u.templateType2Id==601?u.businessId:u.spuId,"min-share-amount":e(Z)(u).minAmount,"max-share-amount":e(Z)(u).maxAmount,"share-city-code":u.templateType2Id==601?e(o).cityId.toString():"",onInView:$=>e(a).itemInView(F==e(a).list.length-1)},null,8,["spu","real-spu-id","min-share-amount","max-share-amount","share-city-code","onInView"]))),128))]),_:1},8,["loading","error","finished","finished-text","onLoad"])]),_:1},8,["style"])}}});var bt=V(Dt,[["__scopeId","data-v-1af80eee"]]);const Bt=(t,n,s,o)=>{const i=K({list:[],loading:!1,error:!1,finished:!1,start:0,load:()=>w(void 0,null,function*(){let r;t.value&&(r=`${t.value.lat},${t.value.lng}`);const g=!h.value;try{const m=yield oe(X(W({},a.value),{shareReq:1,isShowHideSpu:1,cityId:n.value.cityId,start:i.start,tabs:"3",type:3,openOption:g,longLatitude:r}));if(g&&(f.value=m.categoryInfo),m.cmmdtyInfo){const E=m.cmmdtyInfo.list||[];i.list.push(...E),i.start+=E.length,i.list.length==m.cmmdtyInfo.total&&(i.finished=!0)}yield Q(),i.loading=!1}catch(m){i.loading=!1,i.error=!0}}),itemInView:(r=!1)=>{}}),f=C([]),_=T(()=>[P.Category,P.District,P.Earn,P.Sale]),d=C({shareGoodsOnly:1,shareAmountSort:!0}),a=C(d.value),h=T(()=>!!(s.value&&(!s.value.allCategoryInfos[0].list[0].selected||!s.value.allDistricts[0].selected))),v=T(()=>o.value);return{spuList:i,categoryInfo:f,filterOptions:_,filterInitData:d,filterIsClassify:h,recommendSpus:v,filterChange:r=>{a.value=r,i.list=[],i.loading=!0,i.error=!1,i.finished=!1,i.start=0,i.load()},filterReset:()=>{s.value&&s.value.reset()}}};const $t={class:"spu-list"},wt=U({props:{position:{type:Object,default(){return null}},cityInfo:{type:Object,default(){return G}},districts:{type:Array,default(){return[]}},allRecommendSpus:{type:Array,default(){return[]}}},setup(t){const n=t,{position:s,cityInfo:o,allRecommendSpus:i}=M(n),{classifySortOffsetTop:f,classifySortStickyDistance:_}=ae(),d=C(),{spuList:a,categoryInfo:h,filterOptions:v,filterInitData:k,filterIsClassify:c,recommendSpus:r,filterChange:g,filterReset:m}=Bt(s,o,d,i);return(E,I)=>{const N=L("ClassifySort"),j=L("EmptyError");return l(),x(e(te),{title:"\u6210\u957F\u52A0",name:"chengzhangjia",style:ee(`min-height: calc(100vh - ${Number(e(f))-1}px)`)},{default:B(()=>[S(N,{ref_key:"classifySort",ref:d,immediate:"",options:e(v),"initial-filter":e(k),"category-infos":e(h),districts:t.districts,"sticky-distance":e(_),"offset-top":e(f),onFilterChange:e(g)},null,8,["options","initial-filter","category-infos","districts","sticky-distance","offset-top","onFilterChange"]),!e(a).loading&&[...e(r),...e(a).list].length==0?(l(),x(j,{key:0,type:e(a).error?"error":"empty",text:e(a).error?"\u52A0\u8F7D\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5":e(c)?"\u6CA1\u6709\u627E\u5230\u7B5B\u9009\u5185\u5BB9\u5462\uFF5E":"\u6CA1\u6709\u627E\u5230\u5185\u5BB9\u5462\uFF5E"},{default:B(()=>[!e(a).error&&e(c)?(l(),y("div",{key:0,class:"reset-classify",onClick:I[0]||(I[0]=(...u)=>e(m)&&e(m)(...u))}," \u91CD\u7F6E\u7B5B\u9009\u9879 ")):b("",!0)]),_:1},8,["type","text"])):b("",!0),p("div",$t,[(l(!0),y(D,null,O(e(r),(u,F)=>(l(),x(z,{key:F,class:"spu-item",spu:u,"real-spu-id":u.spuId,"min-share-amount":u.minSaleRate,"max-share-amount":u.maxSaleRate,recommended:""},null,8,["spu","real-spu-id","min-share-amount","max-share-amount"]))),128))]),S(e(se),{loading:e(a).loading,"onUpdate:loading":I[1]||(I[1]=u=>e(a).loading=u),error:e(a).error,"onUpdate:error":I[2]||(I[2]=u=>e(a).error=u),class:"spu-list",finished:e(a).finished,"finished-text":[...e(r),...e(a).list].length>0?"\u6CA1\u6709\u66F4\u591A\u4E86":"","immediate-check":!1,onLoad:e(a).load},{default:B(()=>[(l(!0),y(D,null,O(e(a).list,(u,F)=>(l(),x(z,{key:F,class:"spu-item",spu:u,"real-spu-id":u.templateType2Id==601?u.businessId:u.spuId,"min-share-amount":e(Z)(u).minAmount,"max-share-amount":e(Z)(u).maxAmount,"share-city-code":u.templateType2Id==601?e(o).cityId.toString():"",onInView:$=>e(a).itemInView(F==e(a).list.length-1)},null,8,["spu","real-spu-id","min-share-amount","max-share-amount","share-city-code","onInView"]))),128))]),_:1},8,["loading","error","finished","finished-text","onLoad"])]),_:1},8,["style"])}}});var Tt=V(wt,[["__scopeId","data-v-361468e2"]]);const Lt=(t,n,s,o)=>{const i=K({list:[],loading:!1,error:!1,finished:!1,start:0,load:()=>w(void 0,null,function*(){let r;t.value&&(r=`${t.value.lat},${t.value.lng}`);const g=!h.value;try{const m=yield oe(X(W({},a.value),{shareReq:1,isShowHideSpu:1,cityId:n.value.cityId,start:i.start,tabs:"3",type:3,openOption:g,longLatitude:r}));if(g&&(f.value=m.categoryInfo),m.cmmdtyInfo){const E=m.cmmdtyInfo.list||[];i.list.push(...E),i.start+=E.length,i.list.length==m.cmmdtyInfo.total&&(i.finished=!0)}yield Q(),i.loading=!1}catch(m){i.loading=!1,i.error=!0}}),itemInView:(r=!1)=>{}}),f=C([]),_=T(()=>[P.Category]),d=C({shareGoodsOnly:1,shareAmountSort:!0}),a=C(d.value),h=T(()=>!!(s.value&&!s.value.allCategoryInfos[0].list[0].selected)),v=T(()=>o.value.filter(r=>r.maxSaleRate>0));return{spuList:i,categoryInfo:f,filterOptions:_,filterInitData:d,filterIsClassify:h,recommendSpus:v,filterChange:r=>{a.value=r,i.list=[],i.loading=!0,i.error=!1,i.finished=!1,i.start=0,i.load()},filterReset:()=>{s.value&&s.value.reset()}}};const Ot={class:"spu-list"},Rt=U({props:{position:{type:Object,default(){return null}},cityInfo:{type:Object,default(){return G}},allRecommendSpus:{type:Array,default(){return[]}}},setup(t){const n=t,{position:s,cityInfo:o,allRecommendSpus:i}=M(n),{classifySortOffsetTop:f,classifySortStickyDistance:_}=ae(),d=C(),{spuList:a,categoryInfo:h,filterOptions:v,filterInitData:k,filterIsClassify:c,recommendSpus:r,filterChange:g,filterReset:m}=Lt(s,o,d,i);return(E,I)=>{const N=L("ClassifySort"),j=L("EmptyError");return l(),x(e(te),{title:"\u81EA\u8425\u670D\u52A1",name:"ziyingfuwu",style:ee(`min-height: calc(100vh - ${Number(e(f))-1}px)`)},{default:B(()=>[S(N,{ref_key:"classifySort",ref:d,immediate:"",options:e(v),"initial-filter":e(k),"category-infos":e(h),"sticky-distance":e(_),"offset-top":e(f),onFilterChange:e(g)},null,8,["options","initial-filter","category-infos","sticky-distance","offset-top","onFilterChange"]),!e(a).loading&&[...e(r),...e(a).list].length==0?(l(),x(j,{key:0,type:e(a).error?"error":"empty",text:e(a).error?"\u52A0\u8F7D\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5":e(c)?"\u6CA1\u6709\u627E\u5230\u7B5B\u9009\u5185\u5BB9\u5462\uFF5E":"\u6CA1\u6709\u627E\u5230\u5185\u5BB9\u5462\uFF5E"},{default:B(()=>[!e(a).error&&e(c)?(l(),y("div",{key:0,class:"reset-classify",onClick:I[0]||(I[0]=(...u)=>e(m)&&e(m)(...u))}," \u91CD\u7F6E\u7B5B\u9009\u9879 ")):b("",!0)]),_:1},8,["type","text"])):b("",!0),p("div",Ot,[(l(!0),y(D,null,O(e(r),(u,F)=>(l(),x(z,{key:F,class:"spu-item",spu:u,"real-spu-id":u.spuId,"min-share-amount":u.minSaleRate,"max-share-amount":u.maxSaleRate,recommended:""},null,8,["spu","real-spu-id","min-share-amount","max-share-amount"]))),128))]),S(e(se),{loading:e(a).loading,"onUpdate:loading":I[1]||(I[1]=u=>e(a).loading=u),error:e(a).error,"onUpdate:error":I[2]||(I[2]=u=>e(a).error=u),class:"spu-list",finished:e(a).finished,"finished-text":[...e(r),...e(a).list].length>0?"\u6CA1\u6709\u66F4\u591A\u4E86":"","immediate-check":!1,onLoad:e(a).load},{default:B(()=>[(l(!0),y(D,null,O(e(a).list,(u,F)=>(l(),x(z,{key:F,class:"spu-item",spu:u,"real-spu-id":u.templateType2Id==601?u.businessId:u.spuId,"min-share-amount":e(Z)(u).minAmount,"max-share-amount":e(Z)(u).maxAmount,onInView:$=>e(a).itemInView(F==e(a).list.length-1)},null,8,["spu","real-spu-id","min-share-amount","max-share-amount","onInView"]))),128))]),_:1},8,["loading","error","finished","finished-text","onLoad"])]),_:1},8,["style"])}}});var Pt=V(Rt,[["__scopeId","data-v-1fe5e4f4"]]);const Nt=(t,n)=>{const s=K({list:[],loading:!1,error:!1,finished:!1,load:()=>w(void 0,null,function*(){var v,k;try{const c=yield We(X(W({},_.value),{cityCode:n.value.cityId,lat:(v=t.value)==null?void 0:v.lat,lng:(k=t.value)==null?void 0:k.lng}));s.loading=!1,s.list.push(...c),s.finished=!0,o.value.length==0&&(o.value=c.map(r=>({name:r[0].storeName,code:r[0].storeCode,selected:!1})))}catch(c){s.loading=!1,s.error=!0}})}),o=C([]),i=T(()=>{const v=[P.Store];return t.value&&v.push(P.Distance),v}),f=C({distanceSort:!0}),_=C(f.value),d=v=>{_.value=v,s.list=[],s.loading=!0,s.error=!1,s.finished=!1,s.load(),a.value={}},a=C({});return{activityList:s,stores:o,filterOptions:i,filterInitData:f,filterChange:d,activityMoreClicked:a,activityMoreClick:v=>w(void 0,null,function*(){const k=v[0].storeCode;q.loading({forbidClick:!0,duration:0,message:"\u52A0\u8F7D\u4E2D..."});const c=yield Xe({storeCode:k});q.clear();const r=c.filter(g=>!v.some(m=>m.activityId==g.activityId));v.push(...r),a.value[k]=!0})}},Ut=t=>{const n=f=>"xbuy-event/1",s=f=>"xbuy-event/1";return{activityLink:n,storeLink:s,storeClick:f=>w(void 0,null,function*(){location.href=s()}),activityClick:f=>w(void 0,null,function*(){location.href=n()})}},Vt=t=>({activityShare:(s,o)=>w(void 0,null,function*(){s.stopPropagation(),q.loading({forbidClick:!0,duration:0,message:"\u52A0\u8F7D\u4E2D..."});const i=(yield me(o.coverPhotoUrl,Number(o.activitySkuPrice)))||o.coverPhotoUrl;q("\u6A21\u62DF\u62C9\u8D77\u539F\u751F\u5206\u4EAB\u9762\u677F\u6210\u529F"),yield he(1500),ye([i])})});const _e=t=>(ie("data-v-99b73c9a"),t=t(),ne(),t),jt=["onClick"],qt={class:"pf-medium"},Mt=["onClick"],Ht={class:"activity-detail"},Yt={class:"activity-name pf-medium"},Zt={class:"activity-time pf-medium"},zt={class:"activity-sign"},Gt={class:"activity-money"},Wt={class:"activity-price"},Xt=_e(()=>p("div",{class:"yen"},"\xA5",-1)),Jt={class:"num pf-medium"},Qt={key:1,class:"num pf-medium"},Kt=["onClick"],es=["onClick"],ts=Y(" \u67E5\u770B\u66F4\u591A"),ss=_e(()=>p("i",null,null,-1)),as=[ts,ss],is=U({props:{position:{type:Object,default(){return null}},cityInfo:{type:Object,default(){return G}}},setup(t){const n=t,{position:s,cityInfo:o}=M(n),{classifySortOffsetTop:i,classifySortStickyDistance:f}=ae(),_=C(),{activityList:d,stores:a,filterOptions:h,filterInitData:v,filterChange:k,activityMoreClicked:c,activityMoreClick:r}=Nt(s,o),{storeClick:g,activityClick:m}=Ut(),{activityShare:E}=Vt();return(I,N)=>{const j=L("ClassifySort2"),u=L("EmptyError"),F=L("BaseImg");return l(),x(e(te),{title:"\u4E92\u52A8\u6D3B\u52A8",name:"huodong",style:ee(`min-height: calc(100vh - ${Number(e(i))-1}px)`)},{default:B(()=>[S(j,{ref_key:"classifySort",ref:_,immediate:"",options:e(h),"initial-filter":e(v),stores:e(a),"sticky-distance":e(f),"offset-top":e(i),onFilterChange:e(k)},null,8,["options","initial-filter","stores","sticky-distance","offset-top","onFilterChange"]),!e(d).loading&&e(d).list.length==0?(l(),x(u,{key:0,type:e(d).error?"error":"empty",text:e(d).error?"\u52A0\u8F7D\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5":"\u6CA1\u6709\u627E\u5230\u5185\u5BB9\u5462\uFF5E"},null,8,["type","text"])):b("",!0),S(e(se),{loading:e(d).loading,"onUpdate:loading":N[0]||(N[0]=$=>e(d).loading=$),error:e(d).error,"onUpdate:error":N[1]||(N[1]=$=>e(d).error=$),class:"activity-list",finished:e(d).finished,"finished-text":e(d).list.length>0?"\u6CA1\u6709\u66F4\u591A\u4E86":"","immediate-check":!0,onLoad:e(d).load},{default:B(()=>[(l(!0),y(D,null,O(e(d).list,($,Se)=>(l(),y("div",{key:Se,class:"store-item"},[p("div",{class:"store-title",onClick:R=>e(g)({storeCode:$[0].storeCode,storeName:$[0].storeName})},[S(F,{class:"store-head",src:$[0].storePhotoUrl,width:"52",height:"52"},null,8,["src"]),p("span",qt,A($[0].storeName),1)],8,jt),(l(!0),y(D,null,O($.slice(0,e(c)[$[0].storeCode]?void 0:2),(R,Ce)=>(l(),y("div",{key:Ce,class:"activity-item",onClick:le=>e(m)(R)},[S(F,{class:"activity-image",src:R.coverPhotoUrl,width:186,height:140},null,8,["src"]),p("div",Ht,[p("div",Yt,A(R.activeTheme),1),p("div",Zt,A(R.activityTimeStartFormat),1),p("div",zt,[p("strong",null,A(R.signUpCount),1),Y("\u4EBA\u5DF2\u62A5\u540D\uFF08"+A(R.limitCount>0?`\u9650\u989D${R.limitCount}`:"\u540D\u989D\u4E0D\u9650")+"\uFF09 ",1)]),p("div",Gt,[p("div",Wt,[Number(R.activitySkuPrice)>0?(l(),y(D,{key:0},[Xt,p("span",Jt,A(e(J)(R.activitySkuPrice)),1)],64)):(l(),y("span",Qt,"\u514D\u8D39"))]),p("div",{class:"activity-share-button",onClick:le=>e(E)(le,R)}," \u7ACB\u5373\u5206\u4EAB ",8,Kt)])])],8,Mt))),128)),$.length>2&&!e(c)[$[0].storeCode]?(l(),y("div",{key:0,class:"activity-more",onClick:R=>e(r)($)},as,8,es)):b("",!0)]))),128))]),_:1},8,["loading","error","finished","finished-text","onLoad"])]),_:1},8,["style"])}}});var ns=V(is,[["__scopeId","data-v-99b73c9a"]]);const rs=()=>{const t=K({list:[],loading:!1,error:!1,finished:!1,load:()=>w(void 0,null,function*(){try{const n=(yield Je()).ItemList||[];t.loading=!1,t.list.push(...n),t.finished=!0}catch(n){t.loading=!1,t.error=!0}})});return{insuranceList:t}},os=()=>{const t=C(!1);return{earnDetailData:C({}),earnDetailShow:t,earnDetailClick:(o,i)=>w(void 0,null,function*(){o.preventDefault()})}},ls=()=>({shareClick:s=>{q("\u6A21\u62DF\u62C9\u8D77\u539F\u751F\u5206\u4EAB\u9762\u677F\u6210\u529F")},signClick:s=>{location.href=s.shareIntegrationUrl}});const ge=t=>(ie("data-v-100cfd3b"),t=t(),ne(),t),us=["href"],cs={class:"insurance-detail"},ds={class:"insurance-name pf-medium"},fs={class:"insurance-desc pf-medium"},ps={class:"insurance-tag"},ms={class:"insurance-money"},hs={class:"insurance-price"},ys=ge(()=>p("div",{class:"yen pf-simbold"},"\xA5",-1)),vs={class:"num pf-simbold"},_s={key:0,class:"qi"},gs=["onClick"],Ss={key:0},Cs={class:"insurance-function"},ks=["onClick"],Is=["onClick"],xs={class:"earn-detail-wrap"},As={class:"earn-detail-content"},Es=ge(()=>p("h1",{class:"earn-detail-header"},"\u4E1A\u7EE9\u660E\u7EC6",-1)),Fs={class:"earn-detail-list"},Ds={class:"earn-detail-list-header pf-simbold"},bs={class:"earn-detail-list-items"},Bs=U({setup(t){const{insuranceList:n}=rs(),{classifySortOffsetTop:s}=ae(),{earnDetailData:o,earnDetailShow:i,earnDetailClick:f}=os(),{shareClick:_,signClick:d}=ls();return(a,h)=>{const v=L("EmptyError"),k=L("BaseImg");return l(),x(e(te),{title:"\u4FDD\u9669",name:"baoxian",style:ee(`min-height: calc(100vh - ${Number(e(s))-1}px)`)},{default:B(()=>[!e(n).loading&&e(n).list.length==0?(l(),x(v,{key:0,type:e(n).error?"error":"empty",text:e(n).error?"\u52A0\u8F7D\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5":"\u6CA1\u6709\u627E\u5230\u5185\u5BB9\u5462\uFF5E"},null,8,["type","text"])):b("",!0),S(e(se),{loading:e(n).loading,"onUpdate:loading":h[0]||(h[0]=c=>e(n).loading=c),error:e(n).error,"onUpdate:error":h[1]||(h[1]=c=>e(n).error=c),class:"insurance-list",finished:e(n).finished,"finished-text":e(n).list.length>0?"\u6CA1\u6709\u66F4\u591A\u4E86":"","immediate-check":!0,onLoad:e(n).load},{default:B(()=>[(l(!0),y(D,null,O(e(n).list,(c,r)=>(l(),y("div",{key:r,class:"insurance-item"},[p("a",{class:"insurance-info",href:c.redirectUrl},[S(k,{class:"insurance-image",src:c.imageUrl,width:190,height:190},null,8,["src"]),p("div",cs,[p("div",ds,A(c.name),1),p("div",fs,A(c.subTitle),1),p("span",ps,A(c.abbr),1),p("div",ms,[p("div",hs,[ys,p("span",vs,A(e(J)(c.salePriceMin)),1),c.salePriceMin<c.salePriceMax?(l(),y("span",_s,"\u8D77")):b("",!0)]),c.recomInfo?(l(),y("div",{key:0,class:"insurance-earn",onClick:g=>e(f)(g,c)},[p("span",null,"\u4F63\u91D1 "+A(c.recomInfo),1),c.recomType==2?(l(),y("i",Ss)):b("",!0)],8,gs)):b("",!0)])])],8,us),p("div",Cs,[p("div",{class:"insurance-sign",onClick:g=>e(d)(c)},"\u7B7E\u5355\u5FC5\u770B",8,ks),p("div",{class:"insurance-share",onClick:g=>e(_)(c)},"\u7ACB\u5373\u5206\u4EAB",8,Is)])]))),128))]),_:1},8,["loading","error","finished","finished-text","onLoad"]),S(e(qe),{class:"earn-detail-overlay",show:e(i)},{default:B(()=>[p("div",xs,[p("div",As,[Es,p("div",Fs,[p("div",Ds,[(l(!0),y(D,null,O(e(o).titleList,(c,r)=>(l(),y("em",{key:r},A(c),1))),128))]),p("ul",bs,[(l(!0),y(D,null,O(e(o).dataList,(c,r)=>(l(),y("li",{key:r,class:"earn-detail-list-item"},[(l(!0),y(D,null,O(c,(g,m)=>(l(),y("em",{key:m},A(g),1))),128))]))),128))])])]),p("div",{class:"earn-detail-close",onClick:h[2]||(h[2]=c=>i.value=!1)}," \u6211\u77E5\u9053\u4E86 ")])]),_:1},8,["show"])]),_:1},8,["style"])}}});var $s=V(Bs,[["__scopeId","data-v-100cfd3b"]]);const ws={class:"share-service-earn"},Ts=U({props:{position:{type:Object,default(){return null}},cityInfo:{type:Object,default(){return G}},districts:{type:Array,default(){return[]}},recommendSpus:{type:Array,default(){return[]}}},setup(t){const n=t,{recommendSpus:s}=M(n),o=C(""),i=T(()=>0),f=({title:_=""})=>{};return(_,d)=>(l(),y("div",ws,[S(e(Ge),{active:o.value,"onUpdate:active":d[0]||(d[0]=a=>o.value=a),class:"tabs",style:{"--fix-bg":"#ffffff"},ellipsis:!1,sticky:"",shrink:"","offset-top":e(i),onClickTab:f},{default:B(()=>[S(bt,{position:t.position,"city-info":t.cityInfo,districts:t.districts,"all-recommend-spus":e(s)},null,8,["position","city-info","districts","all-recommend-spus"]),S(Tt,{position:t.position,"city-info":t.cityInfo,districts:t.districts,"all-recommend-spus":e(s)},null,8,["position","city-info","districts","all-recommend-spus"]),S(Pt,{position:t.position,"city-info":t.cityInfo,"all-recommend-spus":e(s)},null,8,["position","city-info","all-recommend-spus"]),S(ns,{position:t.position,"city-info":t.cityInfo},null,8,["position","city-info"]),S($s)]),_:1},8,["active","offset-top"])]))}});var Ls=V(Ts,[["__scopeId","data-v-d3065ee8"]]);const Os={class:"share-service"},Rs=U({setup(t){pe(!0);const{position:n,cityInfo:s,districts:o,locationLoaded:i}=Ye({districts:!0,position:!1}),f=C([]),_=C([]),d=C(!1);re(()=>w(this,null,function*(){const{rotationPicList:h,shareTaskList:v}=yield Qe(s.value.cityId);f.value=h||[],_.value=v||[],Q(()=>{d.value=!0}),pe(!1)}));const a=h=>{h.jumpUrl&&(location.href=h.jumpUrl)};return(h,v)=>{const k=L("TitleBar"),c=L("BaseImg");return l(),y("div",Os,[S(k,{"city-name":e(s).cityName,placeholder:"\u8BF7\u8F93\u5165\u60F3\u8981\u5206\u4EAB\u7684\u5546\u54C1",class:"title-bar-comp"},null,8,["city-name"]),f.value.length>0?(l(),x(e(Me),{key:0,class:"share-service-banner","show-indicators":f.value.length>0,autoplay:6e3,loop:!0},{default:B(()=>[(l(!0),y(D,null,O(f.value,(r,g)=>(l(),x(e(He),{key:g,onClick:m=>a(r)},{default:B(()=>[S(c,{src:r.rotationPic,width:"686",height:"240"},null,8,["src"])]),_:2},1032,["onClick"]))),128))]),_:1},8,["show-indicators"])):b("",!0),S(lt,{class:"share-service-task-comp","city-info":e(s),tasks:_.value},null,8,["city-info","tasks"]),d.value&&e(i)?(l(),x(Ls,{key:1,class:"share-service-earn-comp",position:e(n),"city-info":e(s),districts:e(o)},null,8,["position","city-info","districts"])):b("",!0)])}}});var Gs=V(Rs,[["__scopeId","data-v-35464fe2"]]);export{Gs as default};
//# sourceMappingURL=ShareService.92f7aabd.js.map
