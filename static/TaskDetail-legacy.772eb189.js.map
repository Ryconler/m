{"version":3,"file":"TaskDetail-legacy.772eb189.js","sources":["../../src/assets/images/share-service/icon-wechat.png","../../src/assets/images/share-service/icon-moment.png","../../src/assets/images/share-service/icon-download.png","../../src/views/share-service/task-detail/TaskDetail.vue"],"sourcesContent":["export default \"__VITE_ASSET__8d077417__\"","export default \"__VITE_ASSET__8dc5287f__\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAYKADAAQAAAABAAAAYAAAAACpM19OAAAJQUlEQVR4Ae2dT4jVVhTGM2OVLsYKrSKiBReDjhTqouhCRXAWo7VFC9JKHeoM6MqNzFYUBDe2i1r3rYJlqlIKVWyrLpQR7UIp1GLR0VkMorhQF9UBi/VPv18mN5P3Ju+9JC+ZJPPugfOS3Nx7zrnfyT335iY3r80pKL1+/Xq2TFtaxYt0THqQdeg8reJ7Oh4OcltbG3kKR21FsUiAvyVb1oq7xevEy8Vp2fdasq6LL4oviC/JIU+0bW0S6HPEO8VD4hfiqSJ0oRPdc1rKC6pwm3ij+KT4mThvwgZswaa0WlzxfKrKzRBvE98QF5WwDRtnFA/BhBZRGfEO8R1xWQhbsbncjlAFVon/FJeVsH1Vwmsvv2Iyeq74O/ErcdmJOlCXuVkgmnqnI0M3y9Aj4rezMDhHmY+le4eGr6fStKE9LWECfqb4a8n7WTzdwAemd6gbdaSuJKRBqbQAGbRYxpwUr0zDqBLIuCobt6o1jDZra9MOEPgrZMSv4kxiZLMVzLD8I8neKCdca0ZHUyFI4PdIObf2rQY+mFPnCx4GHCeixA6Q4s+l8Yy4I5Hm6VGIup/xsEhUo0QhyFM4KI2JyieytNiFmOzrVTg6HtfM2AB6TY4rP7WRQFyjC5r/P9n1sZxwPo59sRwg8OlwifmtHHbq4Tumk91xOubIDhD4iyWcHp/Ox1JtBBgdrZATRmtnmTgTqRMW+IQbxvkW/Ansau2BEdPbkUJ0JAdI4FfiVrnJqgVsnHSwArOG1DAEyZPM7TC9YCk+Ap8oFNWdO6rrAIFPc+Lh9nSc24kPZ/wSTOB1yQn0C6HUKAR9qVIW/FDoIiUygQeGNalmC9DVz4OIy+KaeWpKtSeCCHCTtkat4PdgotkPBVfg8yjuDzGvhlhqHgFeiflATnhZLapWCOpXRgt+NVrJj8GyP6z4pBbgXf23lLkzrIBNS4zAiErSIVe0grAWsFUZSwH+2bNnHbgkBKZgW0FvBI909dMi9gTTiroP8Hv37vXN27Bhg79f4J09wvi4WgEds0sVDlDKh+L3xk9l+/vq1Svn9u3bzs2bN52HDx82VDZr1ixn/fr1zoIFC9y8d+/e9csE9x88eOCcO3fOef78uX++1s68efOcZcuWOUuWLHHa28OCQa2SidPBFox5guhStQP6zIkstyMjI87+/fudW7foaqITV/2JEyfqFhgYGHCQH4e6urpcezo7O+MUS5oXjH0H+G5X05ijE5uSSo1aDnC2b98eG/yo8pPk40LApriOS6JLZTZ5WLvFgy3gU6W8mVBopGKEHa58Ex46Ojqcnp4eZ+7cxpOsJgQ1UnTo0KHIIejRo0fO+fPnnbGxMdcmbDt27FjW4QiMwfpb6hJ0wBckZEnEfBN2AH9wcNBZuHBhqirpI/r7+yPL7Ovrc3p7e10nYBs2EpIyJrB2HeCGIDUJFkeszlip2+EaHVz5aYNvZMfZYgO2GGJQMAW02sPcMX3AWinN/E3g4GgnStiZAiBcFUFbgjZmqB+swdx3QHeGyqzocARczE0LsA4IBynL1HUIb1csYsXh+1lqsrJDEVgO9rQAloJOmpQLLWIT00QAzJcaB6Qp2MqKjoB1QHSsMslpHZAJrNGFug54N3p+mzNlBBbRB9j3PFNGNYY4dxTEMNRSPghYB+SDu6/VOsCHIp8d1wH5qLZaXQTohAv5IaMW8c/TwjvgypUrDhyXkpaLq6fJ/E95IlbYFgCIu3fvduu4efNmZ9++fZHqe+DAAefUqfG3wg8fPuysXp35s6ZIdoVkKn4LMEYDKMA2oiD4jfIW4LzrgHsFMCTUBK5crnxDjZxQDT5lC3z1U617hCAWYBSWTNgxIcVs58+fX2FzGPimbEXGYh0MF94B4GWANOCzXbqUxxjjNDQ05AwPT1xHcfoLIyOn7TCjoAnLc7IiilqcEAxHQcCD+yUCn2r7DvBfFo0CRl55qp1QbUfJwAfz4Xa9qcswlBUcpaBaTigZ+GB9HewJQdDF8U05fqudUELwfczphCG+/zDg7pXkByd0d3e71hZ8qFkLUTD33w29pP2X4szfjkNpWlRS4Kk+WIP5+JtxikVPtB9/wgUJlpIgcMXD3H81ESHfJ5EUpwwrUgzxanhRKGhL0MYM7fOxNp0wun4U/5uhUnc5kJHPe/n37983h7ltsQFbDLFkKWMCY7B2yXTCjprEP3pV7rRSP/POpb5hLRbv3vMePosieC8/6gKN1I2RwOACDeRjGzZmTKfB2uioeCVRDtioE7+Yk1lszRIls0omCx1JZLICh9UxU7BO7CM5YPIaMc/o37T9O0kFopahglR0ClahRDXJtWWKwAdbMPapogWQqlawTZtBP0dGO3GXqWZhRg7LVPmy4g/BuoQ5gHsB1o92BjPa/aYRYO1s408VyEPcJBxsWp0VUI3AQQ/bivRJLYCzCkO0Avu5mgqomjpgsjP652o8T+1SoVJMUzcFTfaFwXBX2NWP6uCNWIUpKsAXno5WJNqDJAgc9bAMLRsagkxOhSKWsNMh8+0zS/EReKwiyT/aJ88xYbMjvl5bwkOAvzypO+lVMwQZCCXglPa/Mcd2GxmBQx52dQvUDUGmpELRTO1fFq80aXZbF4GrOsuXEvmiel2K5AAkyAmLtbkmbvxpE2VqYSLkpPvxbsCUN0e1YbJuTGwpHAGw4X9lRsNPT05t2AcEi0gwLWCLuGHTCpZrkX0w2eJhFLnKsRyAVCng6UWf2N6kAcg4gUWfh41Ji7SN7QCkShH/ldIrti1hHINE/x/jYslPUlLH3KOyP4k7ksooeTliPmFn4plmzApFHgXVkisnrNA5nvC02uiI0U6+f+SGU+R9OmacwNi3VYi6MtSk7k1Roj6gWqMMGVXaGnEr3DFTR26yqHPT1HQIqrZAIYklLUfE0+2PH5hYK+7f2RpH6Mpg7ojVEzhhOgxVqQN1YVaTupWH1BrsX5rn7S45YYZ4h/iOuCyErdjMo9npQVRGvE18Q1xUwjZsnD7AV18+qlybeKOYf5t7Js6bsAFbsCn1QUl1/Qt1rArPEe8UD4lfiKeK0IVOdPPV+NyoMB4XEHy/eq2422O+ZZqWfYxk/hJf8PiSRjSsicid0qpg6hWRQ2ZLKMPZIC/SMelB1qH7vQsWGxq+p32W3/oswDlXOPoflMDeFj0pAR4AAAAASUVORK5CYII=\"","<template>\n  <div v-if=\"taskDetail\" class=\"task-detail\">\n    <div v-if=\"statusMaterials.length > 0\">\n      <div class=\"materials\">\n        <div\n          v-for=\"(item, index) in statusMaterials\"\n          :key=\"index\"\n          class=\"material\"\n        >\n          <div\n            v-if=\"item.materialType == MaterialType.Video\"\n            class=\"material-video\"\n            @click=\"videoClick(index)\"\n          >\n            <video :src=\"`${item.picUrl}\\#t=0.1`\" preload=\"metadata\"></video>\n            <i class=\"play-icon\"></i>\n          </div>\n          <BaseImg\n            v-else\n            :src=\"item.picUrl\"\n            :width=\"212\"\n            :height=\"212\"\n            @click=\"imageClick(index)\"\n          />\n          <VanCheckbox v-model=\"item.checked\"></VanCheckbox>\n        </div>\n      </div>\n      <div class=\"tip\">*视频需点击后下载，仅支持下载到相册再分享</div>\n    </div>\n    <div v-if=\"taskDetail.shareArticle\" class=\"desc\">\n      <div class=\"desc-text\">{{ taskDetail.shareArticle }}</div>\n      <div class=\"desc-function\">\n        <div class=\"count\">{{ taskDetail.shareArticle.length }}/100</div>\n        <div class=\"copy-button\" @click=\"copyClick\">复制推荐语</div>\n      </div>\n    </div>\n    <div class=\"channels\">\n      <div class=\"channel\" @click=\"wechatClick\">\n        <img src=\"@/assets/images/share-service/icon-wechat.png\" />\n        <span>微信好友</span>\n      </div>\n      <div class=\"channel\" @click=\"momentClick\">\n        <img src=\"@/assets/images/share-service/icon-moment.png\" />\n        <span>朋友圈</span>\n      </div>\n      <div class=\"channel\" @click=\"downloadClick\">\n        <img src=\"@/assets/images/share-service/icon-download.png\" />\n        <span>下载素材</span>\n      </div>\n    </div>\n\n    <VanOverlay class=\"share-overlay\" :show=\"dialogShow\">\n      <div class=\"share-dialog\">\n        <!-- 复制、保存进度 -->\n        <div class=\"share-progress\">\n          <div\n            v-if=\"dialogCopyStatus == OperationStatus.Loading\"\n            class=\"share-progress-item loading\"\n          >\n            分享推荐语正在复制…\n          </div>\n          <div\n            v-else-if=\"dialogCopyStatus == OperationStatus.Succeed\"\n            class=\"share-progress-item success\"\n          >\n            分享推荐语已复制\n          </div>\n          <div\n            v-else-if=\"dialogCopyStatus == OperationStatus.Failed\"\n            class=\"share-progress-item fail\"\n          >\n            分享推荐语复制失败\n          </div>\n          <div\n            v-if=\"dialogDownloadStatus == OperationStatus.Loading\"\n            class=\"share-progress-item loading\"\n          >\n            图片/视频正在保存到相册…\n          </div>\n          <div\n            v-else-if=\"dialogDownloadStatus == OperationStatus.Succeed\"\n            class=\"share-progress-item success\"\n          >\n            图片/视频已保存到相册\n          </div>\n          <div\n            v-else-if=\"dialogDownloadStatus == OperationStatus.Failed\"\n            class=\"share-progress-item fail\"\n          >\n            图片/视频保存相册失败\n          </div>\n        </div>\n        <!-- 分享微信好友 -->\n        <div v-if=\"dialogType == DialogType.ShareWxChat\" class=\"share-content\">\n          <div class=\"share-title\">分享给微信好友</div>\n          <div class=\"share-tutorial\">\n            <div class=\"share-tutorial-item\">打开<br />微信</div>\n            <i class=\"share-tutorial-arrow\"></i>\n            <div class=\"share-tutorial-item\">粘贴文案<br />上传图片/视频</div>\n            <i class=\"share-tutorial-arrow\"></i>\n            <div class=\"share-tutorial-item\">确认<br />分享</div>\n          </div>\n          <button\n            class=\"share-button\"\n            :disabled=\"\n              dialogCopyStatus == OperationStatus.Loading ||\n              dialogDownloadStatus == OperationStatus.Loading\n            \"\n            @click=\"Toast('模拟原生打开微信成功...')\"\n          >\n            <i></i>打开微信\n          </button>\n        </div>\n        <!-- 分享微信朋圈 -->\n        <div\n          v-else-if=\"dialogType == DialogType.ShareWxMoment\"\n          class=\"share-content\"\n        >\n          <div class=\"share-title\">分享到朋友圈</div>\n          <div class=\"share-tutorial\">\n            <div class=\"share-tutorial-item\">打开<br />微信</div>\n            <i class=\"share-tutorial-arrow\"></i>\n            <div class=\"share-tutorial-item\">打开<br />朋友圈</div>\n            <i class=\"share-tutorial-arrow\"></i>\n            <div class=\"share-tutorial-item\">粘贴文案<br />上传图片/视频</div>\n            <i class=\"share-tutorial-arrow\"></i>\n            <div class=\"share-tutorial-item\">确认<br />分享</div>\n          </div>\n          <button\n            class=\"share-button\"\n            :disabled=\"\n              dialogCopyStatus == OperationStatus.Loading ||\n              dialogDownloadStatus == OperationStatus.Loading\n            \"\n            @click=\"Toast('xxx')\"\n          >\n            <i></i>打开微信\n          </button>\n        </div>\n        <!-- 下载素材 -->\n        <div\n          v-else-if=\"dialogType == DialogType.Download\"\n          class=\"share-content\"\n        >\n          <div\n            v-if=\"\n              dialogCopyStatus == OperationStatus.Loading ||\n              dialogDownloadStatus == OperationStatus.Loading\n            \"\n            class=\"download-title\"\n          >\n            正在保存中，请保持打开状态稍等…\n          </div>\n          <button v-else class=\"close-button\" @click=\"dialogShow = false\">\n            保存完成\n          </button>\n        </div>\n        <div class=\"share-close\" @click=\"dialogShow = false\"></div>\n      </div>\n    </VanOverlay>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { Overlay as VanOverlay } from 'vant'\nimport {\n  copyTextClipboard,\n  setLoading,\n  getPosterBase64,\n  videoPreview,\n  sleep,\n  getImageBase64\n} from '@/utils'\nimport { computed, onMounted, Ref, ref } from 'vue'\nimport {\n  Checkbox as VanCheckbox,\n  Toast,\n  ImagePreview as VanImagePreview\n} from 'vant'\nimport { useRoute } from 'vue-router'\nimport {\n  MaterialType,\n  ShareMaterialType,\n  ShareTaskType\n} from '@/constant/shareService'\nimport { useLocation } from '@/composables/common'\nimport { queryShareTask } from '@/api/shareService'\nimport { get } from 'lodash'\nimport { queryShareKey } from '@/api/common'\n\nenum DialogType {\n  ShareWxChat,\n  ShareWxMoment,\n  Download\n}\nenum OperationStatus {\n  Loading,\n  Succeed,\n  Failed\n}\n\nsetLoading(true)\n\nconst route = useRoute()\n\nconst shareKey = ref('')\n\nconst taskDetail: Ref<ShareTaskType | null> = ref(null)\nconst statusMaterials: Ref<(ShareMaterialType & { checked: boolean })[]> = ref(\n  []\n)\nconst selectedImgs = computed(() => {\n  return statusMaterials.value.filter(\n    item => item.checked && item.materialType != MaterialType.Video\n  )\n})\nconst selectedVideos = computed(() => {\n  return statusMaterials.value.filter(\n    item => item.checked && item.materialType == MaterialType.Video\n  )\n})\nconst dialogShow = ref(false)\n\nconst dialogType = ref(DialogType.ShareWxChat)\nconst dialogCopyStatus = ref(OperationStatus.Loading)\nconst dialogDownloadStatus = ref(OperationStatus.Loading)\n\nconst { cityInfo } = useLocation({ districts: false })\n\nconst cityId = computed(() => {\n  return <string>route.query.cityId || cityInfo.value.cityId\n})\n\nonMounted(async () => {\n  const taskList = (await queryShareTask(cityId.value)).shareTaskList || []\n  const taskId = Number(route.params.taskId)\n  taskDetail.value = taskList.find(item => item.id == taskId) || null\n  if (taskDetail.value && taskDetail.value.shareMaterialList) {\n    if (taskDetail.value.shareMaterialList.length == 1) {\n      // 一张图的时候 默认选中\n      statusMaterials.value = [\n        {\n          ...taskDetail.value.shareMaterialList[0],\n          checked: true\n        }\n      ]\n    } else {\n      // 多张图默认选中第一张海报  如果没有海报选中第一张保险海报 都没有不选中\n      const hasPoster = taskDetail.value.shareMaterialList.some(\n        item => item.materialType == MaterialType.Poster\n      )\n      let firstChecked = false //首张海报是否已选取\n      statusMaterials.value = taskDetail.value.shareMaterialList.map(item => {\n        const status = {\n          ...item,\n          checked: false\n        }\n        if (\n          !firstChecked &&\n          (hasPoster\n            ? item.materialType == MaterialType.Poster\n            : item.materialType == MaterialType.BxPoster)\n        ) {\n          status.checked = true\n          firstChecked = true\n        }\n        return status\n      })\n    }\n  }\n  shareKey.value = await queryShareKey({})\n  setLoading(false)\n})\n\nconst imageClick = (originIndex: number) => {\n  let beforeVideoNum = 0 //点击图片之前视频的数量\n  const imgUrls =\n    taskDetail.value && taskDetail.value.shareMaterialList\n      ? taskDetail.value.shareMaterialList\n          .filter((item, index) => {\n            if (item.materialType == MaterialType.Video) {\n              index < originIndex && beforeVideoNum++\n              return false\n            } else {\n              return true\n            }\n          })\n          .map(item => item.picUrl)\n      : []\n  VanImagePreview({\n    images: imgUrls,\n    startPosition: originIndex - beforeVideoNum\n  })\n}\n\nconst videoClick = (index: number) => {\n  videoPreview({\n    videoUrl: get(taskDetail.value, `shareMaterialList[${index}].picUrl`, '')\n  })\n}\n\nconst copyClick = async () => {\n  const res = await copyTextClipboard(taskDetail.value?.shareArticle)\n  if (res) {\n    Toast('复制成功')\n  } else {\n    Toast('复制失败')\n  }\n}\n\nconst wechatClick = async () => {\n  Toast.loading({\n    duration: 0,\n    forbidClick: true,\n    message: '加载中...'\n  })\n  try {\n    const res = await copyTextClipboard(taskDetail.value?.shareArticle) // 需要放到setShareInfo前面执行，不然复制不成功\n    await setShareInfo()\n    if (res) {\n      Toast({\n        message: '复制推荐语成功',\n        duration: 0\n      })\n      await sleep(1000)\n    }\n    // 拉起微信好友分享\n    Toast('模拟原生拉起微信成功...')\n  } catch (err) {\n    if (err == 'no media') {\n      Toast('请选择图片/视频')\n    } else if (err == 'invalid media') {\n      // 选择了多个图片或视频，走下载逻辑\n      Toast.clear()\n      handleCopyAndSave(false, DialogType.ShareWxChat)\n    } else {\n      Toast('分享失败')\n    }\n  }\n}\n\nconst momentClick = async () => {\n  Toast.loading({\n    duration: 0,\n    forbidClick: true,\n    message: '加载中...'\n  })\n  try {\n    const res = await copyTextClipboard(taskDetail.value?.shareArticle)\n    await setShareInfo()\n    if (res) {\n      Toast({\n        message: '复制推荐语成功',\n        duration: 0\n      })\n      await sleep(1000)\n    }\n    // 拉起微信朋友圈分享\n    Toast('模拟原生拉起微信朋友圈成功...')\n  } catch (err) {\n    if (err == 'no media') {\n      Toast('请选择图片/视频')\n    } else if (err == 'invalid media') {\n      // 选择了多个图片或视频，走下载逻辑\n      Toast.clear()\n      handleCopyAndSave(false, DialogType.ShareWxMoment)\n    } else {\n      Toast('分享失败')\n    }\n  }\n}\n\nconst downloadClick = () => {\n  if (selectedImgs.value.length == 0 && selectedVideos.value.length == 0) {\n    Toast('请选择图片/视频')\n    return\n  }\n  handleCopyAndSave(false, DialogType.Download)\n}\n\n/* 设置分享信息 */\nasync function setShareInfo() {\n  if (selectedImgs.value.length == 0 && selectedVideos.value.length == 0) {\n    throw 'no media'\n  } else if (\n    selectedImgs.value.length == 1 &&\n    selectedVideos.value.length == 0\n  ) {\n    //只选了一张图片\n    try {\n      const selectedImg = selectedImgs.value[0]\n      let base64 = ''\n      if (\n        selectedImg.materialType == MaterialType.BxPoster ||\n        selectedImg.materialType == MaterialType.Poster\n      ) {\n        try {\n          base64 = await getPosterBase64(\n            selectedImg.picUrl,\n            selectedImg.spuId,\n            selectedImg.shareLink,\n            shareKey.value\n          )\n        } catch (e) {\n          base64 = await getImageBase64(selectedImg.picUrl)\n        }\n      } else {\n        base64 = await getImageBase64(selectedImg.picUrl)\n      }\n      return 'setImageShare success'\n    } catch (e) {\n      throw 'getImageBase64 fail'\n    }\n  } else {\n    throw 'invalid media'\n  }\n}\n\n/* 复制推荐语、保存图片视频，默认静默下载不显示弹窗 */\nasync function handleCopyAndSave(silence = true, type = DialogType.Download) {\n  if (!silence) {\n    dialogShow.value = true\n    dialogType.value = type\n    dialogCopyStatus.value = OperationStatus.Loading\n    dialogDownloadStatus.value = OperationStatus.Loading\n  }\n  const res = await copyTextClipboard(taskDetail.value?.shareArticle)\n  if (!silence) {\n    dialogCopyStatus.value = res\n      ? OperationStatus.Succeed\n      : OperationStatus.Failed\n  }\n  await sleep(500)\n  const mediaUrls: string[] = []\n  const posterPromises: Promise<string>[] = []\n  for (const material of statusMaterials.value) {\n    if (material.checked) {\n      if (\n        material.materialType == MaterialType.BxPoster ||\n        material.materialType == MaterialType.Poster\n      ) {\n        posterPromises.push(\n          new Promise(resolve => {\n            getPosterBase64(material.picUrl, material.shareLink, shareKey.value)\n              .then(poster => {\n                mediaUrls.push(poster)\n                resolve('success')\n              })\n              .catch(() => {\n                mediaUrls.push(material.picUrl)\n                resolve('success')\n              })\n          })\n        )\n      } else {\n        mediaUrls.push(material.picUrl)\n      }\n    }\n  }\n  // 所有海报生成成功后，保存图片视频\n  Promise.all(posterPromises).then(() => {\n    console.log('开始保存图片/视频')\n    dialogDownloadStatus.value = OperationStatus.Succeed\n  })\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.task-detail {\n  padding: 24px 32px;\n  .materials {\n    display: flex;\n    flex-wrap: wrap;\n    margin-bottom: 12px;\n    .material {\n      position: relative;\n      width: 212px;\n      height: 212px;\n      margin-right: 24px;\n      margin-bottom: 24px;\n      border-radius: 8px;\n      overflow: hidden;\n      &:nth-child(3n) {\n        margin-right: 0;\n      }\n      &:nth-last-child(1),\n      &:nth-last-child(2),\n      &:nth-last-child(3) {\n        margin-bottom: 0;\n      }\n      .material-video {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        video {\n          display: block;\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n          z-index: 1;\n        }\n        .play-icon {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 64px;\n          height: 64px;\n          background: url('@/assets/images/share-service/icon-play.png') 0 0/100%\n            100% no-repeat;\n          z-index: 2;\n        }\n      }\n      .van-checkbox {\n        position: absolute;\n        right: 0;\n        bottom: 0;\n        padding: 12px;\n        :deep(.van-checkbox__icon) {\n          font-size: 40px;\n          &.van-checkbox__icon {\n            .van-icon {\n              background-color: #ffffff;\n              border-color: rgba(214, 214, 214, 1);\n            }\n          }\n          &.van-checkbox__icon--checked {\n            .van-icon {\n              background-color: #ff397e;\n              border-color: #ff397e;\n            }\n          }\n        }\n      }\n    }\n  }\n  .tip {\n    font-size: 26px;\n    color: #ff5900;\n    line-height: 37px;\n    margin-bottom: 40px;\n  }\n  .desc {\n    padding: 20px 24px;\n    background: #f9f9fb;\n    border-radius: 12px;\n    margin-bottom: 40px;\n    .desc-text {\n      font-size: 24px;\n      color: #666666;\n      line-height: 36px;\n      word-break: break-all;\n      white-space: pre-wrap;\n      margin-bottom: 20px;\n    }\n    .desc-function {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      .count {\n        font-size: 24px;\n        color: #bebebe;\n      }\n      .copy-button {\n        width: 170px;\n        height: 48px;\n        border: 2px solid rgba(253, 70, 126, 1);\n        border-radius: 30px;\n        line-height: 48px;\n        text-align: center;\n        font-size: 26px;\n        color: #fd467e;\n      }\n    }\n  }\n  .channels {\n    display: flex;\n    justify-content: space-between;\n    padding: 0 16px;\n    .channel {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      img {\n        width: 96px;\n        height: 96px;\n        border-radius: 50%;\n        margin-bottom: 12px;\n      }\n      span {\n        font-size: 24px;\n        color: #666666;\n      }\n    }\n  }\n}\n.share-overlay {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 3;\n  .share-dialog {\n    width: 580px;\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n    .share-progress {\n      width: 100%;\n      height: 224px;\n      background: url('@/assets/images/share-service/bg-share_progress.png') 0 0/100%\n        100% no-repeat;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      padding-left: 102px;\n      box-sizing: border-box;\n      .share-progress-item {\n        display: flex;\n        align-items: center;\n        margin-bottom: 24px;\n        height: 36px;\n        font-size: 26px;\n        color: #262626;\n        &:last-child {\n          margin-bottom: 0;\n        }\n        &.loading::before {\n          content: '';\n          display: block;\n          width: 28px;\n          height: 28px;\n          background: url('@/assets/images/share-service/icon-loading.png') 0 0/100%\n            100% no-repeat;\n          margin-right: 24px;\n          animation: rotate 1s infinite linear;\n          @keyframes rotate {\n            0% {\n              transform: rotate(0);\n            }\n            100% {\n              transform: rotate(360deg);\n            }\n          }\n        }\n        &.success::before {\n          content: '';\n          display: block;\n          width: 28px;\n          height: 28px;\n          background: url('@/assets/images/share-service/icon-success.png') 0 0/100%\n            100% no-repeat;\n          margin-right: 24px;\n        }\n        &.fail::before {\n          content: '';\n          display: block;\n          width: 28px;\n          height: 28px;\n          background: url('@/assets/images/share-service/icon-fail.png') 0 0/100%\n            100% no-repeat;\n          margin-right: 24px;\n        }\n      }\n    }\n    .share-content {\n      width: 100%;\n      background: #ffffff;\n      padding: 40px 0 48px;\n      border-bottom-left-radius: 12px;\n      border-bottom-right-radius: 12px;\n      margin-bottom: 44px;\n      display: flex;\n      align-items: center;\n      flex-direction: column;\n      .share-title {\n        display: flex;\n        align-items: center;\n        height: 42px;\n        font-size: 30px;\n        color: #262626;\n        margin-bottom: 38px;\n        &::before {\n          content: '';\n          display: block;\n          width: 36px;\n          height: 1px;\n          background: #d8d8d8;\n          margin-right: 16px;\n        }\n        &::after {\n          content: '';\n          display: block;\n          width: 36px;\n          height: 1px;\n          background: #d8d8d8;\n          margin-left: 16px;\n        }\n      }\n      .share-tutorial {\n        display: flex;\n        align-items: center;\n        margin-bottom: 48px;\n        .share-tutorial-item {\n          text-align: center;\n          line-height: 36px;\n          font-size: 26px;\n          color: #262626;\n        }\n        .share-tutorial-arrow {\n          width: 40px;\n          height: 28px;\n          background: url('@/assets/images/share-service/icon-arrow.png') 0 0/100%\n            100% no-repeat;\n          margin: 0 15px;\n        }\n      }\n      .share-button {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        width: 400px;\n        height: 60px;\n        font-size: 26px;\n        color: #ffffff;\n        background: #ff397e;\n        border-radius: 31px;\n        i {\n          width: 30px;\n          height: 30px;\n          background: url('@/assets/images/share-service/icon-wechat-white.png')\n            0 0/100% 100% no-repeat;\n          margin-right: 16px;\n        }\n        &[disabled] {\n          opacity: 0.5;\n        }\n      }\n      .download-title {\n        font-size: 26px;\n        color: #ff397e;\n        margin: 20px 0 12px;\n      }\n      .close-button {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        width: 400px;\n        height: 60px;\n        font-size: 26px;\n        color: #ffffff;\n        background: #ff397e;\n        border-radius: 31px;\n        margin-top: 8px;\n      }\n    }\n    .share-close {\n      width: 58px;\n      height: 58px;\n      background: url('@/assets/images/share-service/icon-close.png') 0 0/100%\n        100% no-repeat;\n    }\n  }\n}\n</style>\n<style lang=\"scss\">\nhtml,\nbody {\n  background: #f4f5fa;\n}\n</style>\n"],"names":["route","useRoute","shareKey","ref","taskDetail","statusMaterials","selectedImgs","computed","value","filter","item","checked","materialType","MaterialType","Video","selectedVideos","dialogShow","dialogType","dialogCopyStatus","dialogDownloadStatus","cityInfo","useLocation","districts","cityId","query","queryShareTask","shareTaskList","taskList","taskId","Number","params","find","id","shareMaterialList","length","hasPoster","some","Poster","firstChecked","map","status","BxPoster","_context","queryShareKey","copyClick","copyTextClipboard","_taskDetail$value","shareArticle","res","wechatClick","loading","duration","forbidClick","message","_context3","_taskDetail$value2","setShareInfo","sleep","clear","momentClick","_context4","_taskDetail$value3","downloadClick","selectedImg","getPosterBase64","picUrl","spuId","shareLink","getImageBase64","silence","type","_taskDetail$value4","mediaUrls","posterPromises","material","push","Promise","then","poster","catch","all","log","index","videoUrl","get","originIndex","beforeVideoNum","imgUrls","images","startPosition"],"mappings":"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"}