var $=Object.defineProperty,ee=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var O=(n,o,i)=>o in n?$(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i,T=(n,o)=>{for(var i in o||(o={}))ae.call(o,i)&&O(n,i,o[i]);if(H)for(var i of H(o))ue.call(o,i)&&O(n,i,o[i]);return n},U=(n,o)=>ee(n,se(o));var E=(n,o,i)=>new Promise((u,g)=>{var y=v=>{try{C(i.next(v))}catch(p){g(p)}},w=v=>{try{C(i.throw(v))}catch(p){g(p)}},C=v=>v.done?u(v.value):Promise.resolve(v.value).then(y,w);C((i=i.apply(n,o)).next())});import{_ as te,d as ie,a_ as S,r as D,e as V,o as le,a$ as F,b2 as oe,L as r,a5 as e,N as re,M as ce,a7 as k,a6 as q,h as R,H as ne,I,aZ as de,a0 as Ae,a1 as he,J as ve,b1 as b,a3 as c,aS as M,b3 as W,b7 as Q,R as pe,K as l,G as Fe,b8 as ge,a8 as d,b4 as Be,F as me}from"./index.8eff2da7.js";import{I as Ce}from"./index.08a7cbc0.js";import{u as fe}from"./index.bd91264b.js";import{d as _e}from"./shareService.e67b80a6.js";import"./position.4bbb72b2.js";import"./storage.ab874d93.js";import"./storage.f0e80fa9.js";import"./city.452f4acf.js";var Ee="/static/icon-wechat.8d077417.png",De="/static/icon-moment.8dc5287f.png",ye="data:image/png;base64,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";const h=n=>(Ae("data-v-571e4803"),n=n(),he(),n),ke={key:0,class:"task-detail"},we={key:0},Ie={class:"materials"},be=["onClick"],Pe=["src"],Te=h(()=>e("i",{class:"play-icon"},null,-1)),Ue=h(()=>e("div",{class:"tip"},"*\u89C6\u9891\u9700\u70B9\u51FB\u540E\u4E0B\u8F7D\uFF0C\u4EC5\u652F\u6301\u4E0B\u8F7D\u5230\u76F8\u518C\u518D\u5206\u4EAB",-1)),Ve={key:1,class:"desc"},Me={class:"desc-text"},Le={class:"desc-function"},xe={class:"count"},He=h(()=>e("img",{src:Ee},null,-1)),Oe=h(()=>e("span",null,"\u5FAE\u4FE1\u597D\u53CB",-1)),Se=[He,Oe],qe=h(()=>e("img",{src:De},null,-1)),Re=h(()=>e("span",null,"\u670B\u53CB\u5708",-1)),We=[qe,Re],Qe=h(()=>e("img",{src:ye},null,-1)),Je=h(()=>e("span",null,"\u4E0B\u8F7D\u7D20\u6750",-1)),Ke=[Qe,Je],Ne={class:"share-dialog"},Ge={class:"share-progress"},Ze={key:0,class:"share-progress-item loading"},Ye={key:1,class:"share-progress-item success"},ze={key:2,class:"share-progress-item fail"},je={key:3,class:"share-progress-item loading"},Xe={key:4,class:"share-progress-item success"},$e={key:5,class:"share-progress-item fail"},es={key:0,class:"share-content"},ss=h(()=>e("div",{class:"share-title"},"\u5206\u4EAB\u7ED9\u5FAE\u4FE1\u597D\u53CB",-1)),as=h(()=>e("div",{class:"share-tutorial"},[e("div",{class:"share-tutorial-item"},[d("\u6253\u5F00"),e("br"),d("\u5FAE\u4FE1")]),e("i",{class:"share-tutorial-arrow"}),e("div",{class:"share-tutorial-item"},[d("\u7C98\u8D34\u6587\u6848"),e("br"),d("\u4E0A\u4F20\u56FE\u7247/\u89C6\u9891")]),e("i",{class:"share-tutorial-arrow"}),e("div",{class:"share-tutorial-item"},[d("\u786E\u8BA4"),e("br"),d("\u5206\u4EAB")])],-1)),us=["disabled"],ts=h(()=>e("i",null,null,-1)),is=d("\u6253\u5F00\u5FAE\u4FE1 "),ls=[ts,is],os={key:1,class:"share-content"},rs=h(()=>e("div",{class:"share-title"},"\u5206\u4EAB\u5230\u670B\u53CB\u5708",-1)),cs=h(()=>e("div",{class:"share-tutorial"},[e("div",{class:"share-tutorial-item"},[d("\u6253\u5F00"),e("br"),d("\u5FAE\u4FE1")]),e("i",{class:"share-tutorial-arrow"}),e("div",{class:"share-tutorial-item"},[d("\u6253\u5F00"),e("br"),d("\u670B\u53CB\u5708")]),e("i",{class:"share-tutorial-arrow"}),e("div",{class:"share-tutorial-item"},[d("\u7C98\u8D34\u6587\u6848"),e("br"),d("\u4E0A\u4F20\u56FE\u7247/\u89C6\u9891")]),e("i",{class:"share-tutorial-arrow"}),e("div",{class:"share-tutorial-item"},[d("\u786E\u8BA4"),e("br"),d("\u5206\u4EAB")])],-1)),ns=["disabled"],ds=h(()=>e("i",null,null,-1)),As=d("\u6253\u5F00\u5FAE\u4FE1 "),hs=[ds,As],vs={key:2,class:"share-content"},ps={key:0,class:"download-title"},Fs=ie({setup(n){S(!0);const o=ve(),i=D(""),u=D(null),g=D([]),y=V(()=>g.value.filter(s=>s.checked&&s.materialType!=F.Video)),w=V(()=>g.value.filter(s=>s.checked&&s.materialType==F.Video)),C=D(!1),v=D(0),p=D(0),f=D(0),{cityInfo:J}=fe({districts:!1}),K=V(()=>o.query.cityId||J.value.cityId);le(()=>E(this,null,function*(){const s=(yield _e(K.value)).shareTaskList||[],a=Number(o.params.taskId);if(u.value=s.find(B=>B.id==a)||null,u.value&&u.value.shareMaterialList)if(u.value.shareMaterialList.length==1)g.value=[U(T({},u.value.shareMaterialList[0]),{checked:!0})];else{const B=u.value.shareMaterialList.some(A=>A.materialType==F.Poster);let t=!1;g.value=u.value.shareMaterialList.map(A=>{const m=U(T({},A),{checked:!1});return!t&&(B?A.materialType==F.Poster:A.materialType==F.BxPoster)&&(m.checked=!0,t=!0),m})}i.value=yield oe({}),S(!1)}));const N=s=>{let a=0;const B=u.value&&u.value.shareMaterialList?u.value.shareMaterialList.filter((t,A)=>t.materialType==F.Video?(A<s&&a++,!1):!0).map(t=>t.picUrl):[];Ce({images:B,startPosition:s-a})},G=s=>{Be({videoUrl:me.exports.get(u.value,`shareMaterialList[${s}].picUrl`,"")})},Z=()=>E(this,null,function*(){var a;(yield b((a=u.value)==null?void 0:a.shareArticle))?c("\u590D\u5236\u6210\u529F"):c("\u590D\u5236\u5931\u8D25")}),Y=()=>E(this,null,function*(){var s;c.loading({duration:0,forbidClick:!0,message:"\u52A0\u8F7D\u4E2D..."});try{const a=yield b((s=u.value)==null?void 0:s.shareArticle);yield L(),a&&(c({message:"\u590D\u5236\u63A8\u8350\u8BED\u6210\u529F",duration:0}),yield M(1e3)),c("\u6A21\u62DF\u539F\u751F\u62C9\u8D77\u5FAE\u4FE1\u6210\u529F...")}catch(a){a=="no media"?c("\u8BF7\u9009\u62E9\u56FE\u7247/\u89C6\u9891"):a=="invalid media"?(c.clear(),P(!1,0)):c("\u5206\u4EAB\u5931\u8D25")}}),z=()=>E(this,null,function*(){var s;c.loading({duration:0,forbidClick:!0,message:"\u52A0\u8F7D\u4E2D..."});try{const a=yield b((s=u.value)==null?void 0:s.shareArticle);yield L(),a&&(c({message:"\u590D\u5236\u63A8\u8350\u8BED\u6210\u529F",duration:0}),yield M(1e3)),c("\u6A21\u62DF\u539F\u751F\u62C9\u8D77\u5FAE\u4FE1\u670B\u53CB\u5708\u6210\u529F...")}catch(a){a=="no media"?c("\u8BF7\u9009\u62E9\u56FE\u7247/\u89C6\u9891"):a=="invalid media"?(c.clear(),P(!1,1)):c("\u5206\u4EAB\u5931\u8D25")}}),j=()=>{if(y.value.length==0&&w.value.length==0){c("\u8BF7\u9009\u62E9\u56FE\u7247/\u89C6\u9891");return}P(!1,2)};function L(){return E(this,null,function*(){if(y.value.length==0&&w.value.length==0)throw"no media";if(y.value.length==1&&w.value.length==0)try{const s=y.value[0];let a="";if(s.materialType==F.BxPoster||s.materialType==F.Poster)try{a=yield W(s.picUrl,s.spuId,s.shareLink,i.value)}catch(B){a=yield Q(s.picUrl)}else a=yield Q(s.picUrl);return"setImageShare success"}catch(s){throw"getImageBase64 fail"}else throw"invalid media"})}function P(s=!0,a=2){return E(this,null,function*(){var m;s||(C.value=!0,v.value=a,p.value=0,f.value=0);const B=yield b((m=u.value)==null?void 0:m.shareArticle);s||(p.value=B?1:2),yield M(500);const t=[],A=[];for(const _ of g.value)_.checked&&(_.materialType==F.BxPoster||_.materialType==F.Poster?A.push(new Promise(x=>{W(_.picUrl,_.shareLink,i.value).then(X=>{t.push(X),x("success")}).catch(()=>{t.push(_.picUrl),x("success")})})):t.push(_.picUrl));Promise.all(A).then(()=>{console.log("\u5F00\u59CB\u4FDD\u5B58\u56FE\u7247/\u89C6\u9891"),f.value=1})})}return(s,a)=>{const B=pe("BaseImg");return u.value?(l(),r("div",ke,[g.value.length>0?(l(),r("div",we,[e("div",Ie,[(l(!0),r(re,null,ce(g.value,(t,A)=>(l(),r("div",{key:A,class:"material"},[t.materialType==I(F).Video?(l(),r("div",{key:0,class:"material-video",onClick:m=>G(A)},[e("video",{src:`${t.picUrl}#t=0.1`,preload:"metadata"},null,8,Pe),Te],8,be)):(l(),Fe(B,{key:1,src:t.picUrl,width:212,height:212,onClick:m=>N(A)},null,8,["src","onClick"])),R(I(ge),{modelValue:t.checked,"onUpdate:modelValue":m=>t.checked=m},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),Ue])):k("",!0),u.value.shareArticle?(l(),r("div",Ve,[e("div",Me,q(u.value.shareArticle),1),e("div",Le,[e("div",xe,q(u.value.shareArticle.length)+"/100",1),e("div",{class:"copy-button",onClick:Z},"\u590D\u5236\u63A8\u8350\u8BED")])])):k("",!0),e("div",{class:"channels"},[e("div",{class:"channel",onClick:Y},Se),e("div",{class:"channel",onClick:z},We),e("div",{class:"channel",onClick:j},Ke)]),R(I(de),{class:"share-overlay",show:C.value},{default:ne(()=>[e("div",Ne,[e("div",Ge,[p.value==0?(l(),r("div",Ze," \u5206\u4EAB\u63A8\u8350\u8BED\u6B63\u5728\u590D\u5236\u2026 ")):p.value==1?(l(),r("div",Ye," \u5206\u4EAB\u63A8\u8350\u8BED\u5DF2\u590D\u5236 ")):p.value==2?(l(),r("div",ze," \u5206\u4EAB\u63A8\u8350\u8BED\u590D\u5236\u5931\u8D25 ")):k("",!0),f.value==0?(l(),r("div",je," \u56FE\u7247/\u89C6\u9891\u6B63\u5728\u4FDD\u5B58\u5230\u76F8\u518C\u2026 ")):f.value==1?(l(),r("div",Xe," \u56FE\u7247/\u89C6\u9891\u5DF2\u4FDD\u5B58\u5230\u76F8\u518C ")):f.value==2?(l(),r("div",$e," \u56FE\u7247/\u89C6\u9891\u4FDD\u5B58\u76F8\u518C\u5931\u8D25 ")):k("",!0)]),v.value==0?(l(),r("div",es,[ss,as,e("button",{class:"share-button",disabled:p.value==0||f.value==0,onClick:a[0]||(a[0]=t=>I(c)("\u6A21\u62DF\u539F\u751F\u6253\u5F00\u5FAE\u4FE1\u6210\u529F..."))},ls,8,us)])):v.value==1?(l(),r("div",os,[rs,cs,e("button",{class:"share-button",disabled:p.value==0||f.value==0,onClick:a[1]||(a[1]=t=>I(c)("xxx"))},hs,8,ns)])):v.value==2?(l(),r("div",vs,[p.value==0||f.value==0?(l(),r("div",ps," \u6B63\u5728\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u4FDD\u6301\u6253\u5F00\u72B6\u6001\u7A0D\u7B49\u2026 ")):(l(),r("button",{key:1,class:"close-button",onClick:a[2]||(a[2]=t=>C.value=!1)}," \u4FDD\u5B58\u5B8C\u6210 "))])):k("",!0),e("div",{class:"share-close",onClick:a[3]||(a[3]=t=>C.value=!1)})])]),_:1},8,["show"])])):k("",!0)}}});var ks=te(Fs,[["__scopeId","data-v-571e4803"]]);export{ks as default};
//# sourceMappingURL=TaskDetail.8ebd7b95.js.map
