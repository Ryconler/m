var S=(e,r,t)=>new Promise((h,n)=>{var k=y=>{try{w(t.next(y))}catch(C){n(C)}},I=y=>{try{w(t.throw(y))}catch(C){n(C)}},w=y=>y.done?h(y.value):Promise.resolve(y.value).then(k,I);w((t=t.apply(e,r)).next())});import{D as re,a9 as z,aa as ee,E as R,_ as G,d as F,R as U,K as o,G as B,H as N,L as c,M as E,I as l,ab as ne,h as $,N as T,ac as ce,ad as te,ae as ie,r as P,a6 as b,a7 as f,a5 as a,a0 as j,a1 as O,a8 as le,af as ue,e as H,w as de,ag as he,ah as Y,j as me,o as pe,ai as _e}from"./index.8eff2da7.js";import{g as ve}from"./position.4bbb72b2.js";import{T as Z,a as ge}from"./index.a19928c9.js";import{I as fe}from"./index.08a7cbc0.js";import"./storage.ab874d93.js";import"./storage.f0e80fa9.js";const V={getPhotographyConfig:`${R.mockApi}/photography-config.json`,getPhotographyInfo:`${R.mockApi}/querySelfPhoto.do`,getPhotographyStores:`${R.mockApi}/store/selfPhotographyStoreList.do`,getMinPriceSpu:`${R.mockApi}/api/spu/queryMinPriceSpuByTheme.do`};function ye(){return S(this,null,function*(){try{const e=yield re.get(`${V.getPhotographyConfig}`),{data:r,code:t}=e;return+t==0?r||{}:{}}catch(e){return{}}})}function be(){return S(this,null,function*(){try{const e=yield z.post(`${V.getPhotographyInfo}`,{cityId:"320100",level3CategoryId:[101215]}),{data:r,code:t}=e;return+t==1?r||{}:{}}catch(e){return{}}})}function Ie(){return S(this,null,function*(){try{const e=yield ve(),r={cityCode:"320100",lng:e?e.lng:"",lat:e?e.lat:""},t=yield z.get(`${V.getPhotographyStores}?${ee.stringify(r)}`),{data:h,code:n}=t;return+n==1?h||[]:[]}catch(e){return[]}})}function we(e){return S(this,null,function*(){try{const r={cityId:"320100",themeId:e},t=yield z.get(`${V.getMinPriceSpu}?${ee.stringify(r)}`),{data:h,code:n}=t;return+n==1?h||{}:{}}catch(r){return{}}})}const Pe=F({props:{banners:{type:Array,default(){return[]}}},setup(e){const r=(t,h)=>{t.link&&(location.href=t.link)};return(t,h)=>{const n=U("BaseImg");return o(),B(l(ce),{class:"banners",autoplay:5e3,"show-indicators":!1},{default:N(()=>[(o(!0),c(T,null,E(e.banners,(k,I)=>(o(),B(l(ne),{key:I,onClick:w=>r(k)},{default:N(()=>[$(n,{src:k.img,width:"750",height:"148"},null,8,["src"])]),_:2},1032,["onClick"]))),128))]),_:1})}}});var ke=G(Pe,[["__scopeId","data-v-350d86ff"]]);const Q=e=>(j("data-v-459aaa51"),e=e(),O(),e),De={class:"tabs-content"},$e={key:0,class:"content-title pf-simbold"},Ce={key:1,class:"themes"},xe={class:"theme-title pf-medium"},Se={class:"theme-pics"},Ne={key:2,class:"products"},Te=Q(()=>a("div",{class:"products-title pf-medium"},[a("i"),le("\u5957\u9910\u63A8\u8350")],-1)),Be={class:"products-list"},Ee=["href"],Ae={class:"product-detail"},Ge={class:"product-info"},Fe={class:"product-title"},qe={key:0,class:"product-photonum"},Me=Q(()=>a("div",{class:"product-btn pf-medium"},"\u67E5\u770B\u8BE6\u60C5",-1)),Re={key:0,class:"product-recommend"},Ue=Q(()=>a("div",{class:"product-recommend-icon"},[a("i"),a("span",{class:"pf-medium"},"\u63A8\u8350")],-1)),je={class:"product-recommend-text"},Oe=F({props:{showTabName:{type:Boolean,default(){return!0}},tabname:{type:String,default:""},themes:{type:Array,default(){return[]}},products:{type:Array,default(){return[]}}},emits:["theme-pic-click"],setup(e,{emit:r}){const t=e,{tabname:h}=te(t),n=ie("photographyConfig",P({})),k=_=>{try{return _&&_.photoItem?JSON.parse(_.photoItem).reduce((d,s)=>d.isGiveNegatives==null?s:s.isGiveNegatives==null||d.isGiveNegatives>s.isGiveNegatives?d:s,{}).isGiveNegatives:void 0}catch(m){return}},I=_=>{if(_)try{const m=JSON.parse(_);if(m.length>0){const u=m[0].photeRepairNum;return`\u62CD\u6444\u2265${m[0].photoNum}\u5F20 | ${u}\u5F20\u7CBE\u4FEE`}}catch(m){console.error(m)}return""},w=_=>{const m=n.value.negativesGiveDescs||{},u=k(_);return u&&m[u]},y=_=>"/xbuy-event/1",C=(_,m)=>{r("theme-pic-click",_,m)};return(_,m)=>{const u=U("BaseImg"),d=U("ProductPrice");return o(),c("div",De,[e.showTabName?(o(),c("div",$e,b(l(h)),1)):f("",!0),e.themes.length>0?(o(),c("div",Ce,[(o(!0),c(T,null,E(e.themes,s=>(o(),c("div",{key:s.themeId,class:"theme"},[a("div",xe,b(s.themeName)+"\uFF08"+b(s.themePics?s.themePics.length:0)+"\uFF09 ",1),a("div",Se,[(o(!0),c(T,null,E(s.themePics,(i,v)=>(o(),B(u,{key:v,class:"theme-pic",width:"210",height:"280",src:i,onClick:g=>C(s,v)},null,8,["src","onClick"]))),128))])]))),128))])):f("",!0),e.products.length>0?(o(),c("div",Ne,[Te,a("div",Be,[(o(!0),c(T,null,E(e.products,s=>(o(),c("a",{key:s.spuId,class:"product",href:y()},[a("div",Ae,[$(u,{class:"product-image",width:"120",height:"120",src:s.cmmdtyImage},null,8,["src"]),a("div",Ge,[a("div",Fe,b(s.spuName),1),I(s.photoItem)?(o(),c("div",qe,b(I(s.photoItem)),1)):f("",!0),$(d,{class:"product-price-wrap",price:s.minPrice},null,8,["price"])]),Me]),w(s)?(o(),c("div",Re,[Ue,a("div",je,b(w(s)),1)])):f("",!0)],8,Ee))),128))])])):f("",!0)])}}});var Ve=G(Oe,[["__scopeId","data-v-459aaa51"]]);const J=e=>(j("data-v-8b5e6d28"),e=e(),O(),e),Je={class:"tabs-stores"},Le=J(()=>a("div",{class:"stores-title pf-medium"},"\u62CD\u6444\u95E8\u5E97",-1)),Ke=["href"],He=J(()=>a("div",{class:"store-icon"},null,-1)),ze={class:"store-info"},Qe={class:"store-title pf-simbold"},We={class:"store-address"},Xe={key:0,class:"store-distance"},Ye=J(()=>a("div",{class:"store-btn"},null,-1)),Ze=J(()=>a("div",{class:"store-divider"},null,-1)),et=F({props:{stores:{type:Array,default(){return[]}}},setup(e){const r=t=>"/xbuy-event/1";return(t,h)=>(o(),c("div",Je,[Le,(o(!0),c(T,null,E(e.stores,n=>(o(),c("a",{key:n.storeId,class:"store",href:r()},[He,a("div",ze,[a("div",Qe,b(n.shortName),1),a("div",We,b(n.addressStreet),1),n.distance>=0?(o(),c("div",Xe," \u8DDD\u60A8 "+b(l(ue)(n.distance))+" km ",1)):f("",!0)]),Ye,Ze],8,Ke))),128))]))}});var tt=G(et,[["__scopeId","data-v-8b5e6d28"]]);const st=e=>(j("data-v-676e40db"),e=e(),O(),e),ot={class:"tabs"},at={class:"pf-medium"},rt={class:"pf-medium gray"},nt=st(()=>a("div",{class:"menu_wkBox_back_box"},null,-1)),ct=F({props:{tabs:{type:Array,default(){return[]}},stores:{type:Array,default(){return[]}}},setup(e){const r=e,t=u=>{try{return u&&u.photoItem?JSON.parse(u.photoItem).reduce((i,v)=>i.isGiveNegatives==null?v:v.isGiveNegatives==null||i.isGiveNegatives>v.isGiveNegatives?i:v,{}).isGiveNegatives:void 0}catch(d){return}},{selectedTab:h,showTabs:n}=(u=>{function d(g){let A=0;for(const x in g){const q=g[x];t(q)=="1"&&(Number(x)>A&&(g.splice(Number(x),1),g.splice(A,0,q)),A++)}}const{tabs:s}=te(u),i=P(0),v=H(()=>s.value.filter(g=>g.cmmdtyInfo&&g.cmmdtyInfo.length>0?(d(g.cmmdtyInfo),!0):!1));return{selectedTab:i,showTabs:v}})(r),{selectedThemeImageStart:k,themeDetailShow:I,themeDetailImages:w,showThemeDetail:y,themeDetailImageIndex:C,themeDetailImageChange:_,themeDetailProduct:m}=(()=>{function u(){me(()=>{document.querySelectorAll("#image-preview .van-swipe-item").forEach((D,oe)=>{const X=i.value[oe].detailDomText,M=D.querySelector(".van-image-preview__image"),ae=M&&M.querySelector(".image-detail");if(X&&M&&!ae)try{const L=new DOMParser().parseFromString(X,"text/html").body.childNodes[0],K=document.createElement("div");K.className="image-detail",K.appendChild(L),M.appendChild(K)}catch(L){console.error("\u6DFB\u52A0\u56FE\u7247\u8BE6\u60C5\u5931\u8D25",L)}})})}function d(){document.querySelectorAll("#image-preview  .image-detail").forEach(D=>{D.remove()})}const s=P(null),i=H(()=>{const p=s.value;return p&&p.themePics?p.themePics.map(D=>({imgUrl:D,detailDomText:`<div class="theme-title pf-medium">${p.themeName}</div>`})):[]}),v=P(0),g=P(!1);de(g,()=>{g.value?setTimeout(()=>{u()},200):d()});const A=H(()=>i.value.map(p=>p.imgUrl)),x=P(0),q=p=>{x.value=p,u()},se=(p,D)=>{s.value=p,v.value=D,x.value=D,g.value=!0},W=P(null);return he(()=>S(this,null,function*(){const p=s.value&&s.value.themeId;p&&(W.value=yield we(p))})),{selectedThemeImageStart:v,themeDetailShow:g,themeDetailImages:A,showThemeDetail:se,themeDetailImageIndex:x,themeDetailImageChange:q,themeDetailProduct:W}})();return(u,d)=>{const s=U("ProductCell");return o(),c("div",ot,[$(l(ge),{active:l(h),"onUpdate:active":d[0]||(d[0]=i=>Y(h)?h.value=i:null),style:{"--fix-bg":"#ffffff"},"title-active-color":"#ff5900","swipe-threshold":4,ellipsis:!1,border:"",scrollspy:"",sticky:""},{default:N(()=>[(o(!0),c(T,null,E(l(n),(i,v)=>(o(),B(l(Z),{key:i.level4Category,title:i.level4Category},{default:N(()=>[$(Ve,{class:"tabs-content-wrap","show-tab-name":v>0,tabname:i.level4Category,themes:i.themes,products:i.cmmdtyInfo,onThemePicClick:l(y)},null,8,["show-tab-name","tabname","themes","products","onThemePicClick"])]),_:2},1032,["title"]))),128)),e.stores&&e.stores.length>0?(o(),B(l(Z),{key:0,title:"\u62CD\u6444\u95E8\u5E97"},{default:N(()=>[$(tt,{stores:e.stores},null,8,["stores"])]),_:1})):f("",!0)]),_:1},8,["active"]),$(l(fe).Component,{id:"image-preview",show:l(I),"onUpdate:show":d[1]||(d[1]=i=>Y(I)?I.value=i:null),images:l(w),"start-position":l(k),"close-on-popstate":!1,teleport:"body",onChange:l(_)},{index:N(()=>[a("span",at,b(l(C)+1),1),a("span",rt,"/"+b(l(w).length),1)]),cover:N(()=>[l(m)?(o(),c(T,{key:0},[$(s,{"product-info":l(m)},null,8,["product-info"]),nt],64)):f("",!0)]),_:1},8,["show","images","start-position","onChange"])])}}});var it=G(ct,[["__scopeId","data-v-676e40db"]]);const lt=e=>(j("data-v-7edfad88"),e=e(),O(),e),ut={class:"photography"},dt={key:0,class:"brand-wrap"},ht=["src"],mt={key:3,class:"flow-wrap"},pt=["src"],_t=lt(()=>a("div",{class:"menu_wkBox_back_box"},null,-1)),vt=F({setup(e){const r=P({}),t=P({}),h=P([]);return pe(()=>S(this,null,function*(){r.value=yield ye(),be().then(n=>{t.value=n}),Ie().then(n=>{h.value=n})})),_e("photographyConfig",r),(n,k)=>(o(),c("div",ut,[r.value.brand?(o(),c("div",dt,[a("img",{src:r.value.brand},null,8,ht)])):f("",!0),t.value.ads&&t.value.ads.length>0?(o(),B(ke,{key:1,class:"banners-wrap",banners:t.value.ads},null,8,["banners"])):f("",!0),t.value.content&&t.value.content.length>0?(o(),B(it,{key:2,class:"tabs-wrap",tabs:t.value.content,stores:h.value},null,8,["tabs","stores"])):f("",!0),r.value.flow?(o(),c("div",mt,[a("img",{src:r.value.flow},null,8,pt)])):f("",!0),_t]))}});var kt=G(vt,[["__scopeId","data-v-7edfad88"]]);export{kt as default};
//# sourceMappingURL=Photography.1d9624d1.js.map
