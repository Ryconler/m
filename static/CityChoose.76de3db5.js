var A=(e,f,t)=>new Promise((u,h)=>{var a=n=>{try{i(t.next(n))}catch(r){h(r)}},s=n=>{try{i(t.throw(n))}catch(r){h(r)}},i=n=>n.done?u(n.value):Promise.resolve(n.value).then(a,s);i((t=t.apply(e,f)).next())});import{u as st}from"./urlPrefixes.2e917cec.js";import{c as K,d as E,r as k,u as ct,a as rt,b as it,e as b,i as at,f as lt,o as V,w as H,g as X,h as x,T as ut,t as dt,n as q,m as ft,j as G,p as ht,k as pt,l as L,q as P,s as gt,v as J,x as vt,y as yt,z as xt,A as mt,B as Ct,C as U,D as It,_ as _t,E as kt,F as j,G as Tt,H as w,I as At,J as _,K as S,L as F,M as R,N as wt}from"./index.b2407a93.js";import{s as St}from"./city.4384b01b.js";import"./storage.2d44022f.js";function Rt(){const e="A".charCodeAt(0);return Array(26).fill("").map((t,u)=>String.fromCharCode(e+u))}const[Z,N]=K("index-bar"),Nt={sticky:dt,zIndex:q,teleport:[String,Object],highlightColor:String,stickyOffsetTop:ft(0),indexList:{type:Array,default:Rt}},Q=Symbol(Z);var bt=E({name:Z,props:Nt,emits:["select","change"],setup(e,{emit:f,slots:t}){const u=k(),h=k(""),a=ct(),s=rt(u),{children:i,linkChildren:n}=it(Q);let r;n({props:e});const m=b(()=>{if(at(e.zIndex))return{zIndex:+e.zIndex+1}}),W=b(()=>{if(e.highlightColor)return{color:e.highlightColor}}),$=(o,c)=>{for(let l=i.length-1;l>=0;l--){const p=l>0?c[l-1].height:0,d=e.sticky?p+e.stickyOffsetTop:0;if(o+d>=c[l].top)return l}return-1},B=o=>i.find(c=>String(c.index)===o),T=()=>{if(pt(u))return;const{sticky:o,indexList:c}=e,l=L(s.value),p=P(s),d=i.map(C=>C.getRect(s.value,p));let v=-1;if(r){const C=B(r);if(C){const y=C.getRect(s.value,p);v=$(y.top,d)}}else v=$(l,d);h.value=c[v],o&&i.forEach((C,y)=>{const{state:g,$el:nt}=C;if(y===v||y===v-1){const I=nt.getBoundingClientRect();g.left=I.left,g.width=I.width}else g.left=null,g.width=null;if(y===v)g.active=!0,g.top=Math.max(e.stickyOffsetTop,d[y].top-l)+p.top;else if(y===v-1&&r===""){const I=d[v].top-l;g.active=I>0,g.top=I+p.top-d[y].height}else g.active=!1}),r=""},O=()=>{G(T)};lt("scroll",T,{target:s}),V(O),H(()=>e.indexList,O),H(h,o=>{o&&f("change",o)});const tt=()=>e.indexList.map(o=>{const c=o===h.value;return x("span",{class:N("index",{active:c}),style:c?W.value:void 0,"data-index":o},[o])}),M=o=>{r=String(o);const c=B(r);if(c){const l=L(s.value),p=P(s),{offsetHeight:d}=document.documentElement;if(l===d-p.height){T();return}c.$el.scrollIntoView(),e.sticky&&e.stickyOffsetTop&&gt(J()-e.stickyOffsetTop),f("select",c.index)}},z=o=>{const{index:c}=o.dataset;c&&M(c)},et=o=>{z(o.target)};let D;const ot=o=>{if(a.move(o),a.isVertical()){ht(o);const{clientX:c,clientY:l}=o.touches[0],p=document.elementFromPoint(c,l);if(p){const{index:d}=p.dataset;d&&D!==d&&(D=d,z(p))}}},Y=()=>x("div",{class:N("sidebar"),style:m.value,onClick:et,onTouchstart:a.start,onTouchmove:ot},[tt()]);return X({scrollTo:M}),()=>{var o;return x("div",{ref:u,class:N()},[e.teleport?x(ut,{to:e.teleport},{default:()=>[Y()]}):Y(),(o=t.default)==null?void 0:o.call(t)])}}});const[Lt,Pt]=K("index-anchor"),Et={index:q};var $t=E({name:Lt,props:Et,setup(e,{slots:f}){const t=vt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),u=k(),{parent:h}=yt(Q);if(!h)return;const a=()=>t.active&&h.props.sticky,s=b(()=>{const{zIndex:n,highlightColor:r}=h.props;if(a())return xt(mt(n),{left:t.left?`${t.left}px`:void 0,width:t.width?`${t.width}px`:void 0,transform:t.top?`translate3d(0, ${t.top}px, 0)`:void 0,color:r})});return X({state:t,getRect:(n,r)=>{const m=P(u);return t.rect.height=m.height,n===window||n===document.body?t.rect.top=m.top+J():t.rect.top=m.top+L(n)-r.top,t.rect}}),()=>{const n=a();return x("div",{ref:u,style:{height:n?`${t.rect.height}px`:void 0}},[x("div",{style:s.value,class:[Pt({sticky:n}),{[Ct]:n}]},[f.default?f.default():e.index])])}}});const Bt=U($t),Ot=U(bt),Mt={getAllCityList:`${st.mapi}/city/getAllCityList`};function zt(){return A(this,null,function*(){try{const e=yield It.get(`${Mt.getAllCityList}`),{data:f,code:t}=e;return t==1?f||[]:[]}catch(e){return[]}})}const Dt=E({setup(e){const f=At(),t=k({}),u=k([]);V(()=>A(this,null,function*(){const a=yield zt();t.value={},t.value=kt.exports.groupBy(a,s=>s.PINYIN&&s.PINYIN[0]);for(const s of Object.values(t.value))s.sort((i,n)=>i.PINYIN<n.PINYIN?-1:1);u.value=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],yield G(),window.scrollTo(0,1),window.scrollTo(0,0)}));const h=a=>{St(a.ID,a.NAME);const s=f.query.referrer||document.referrer||"//m.wzmxx.com";location.href=decodeURIComponent(s.toString())};return(a,s)=>(_(),j(w(Ot),null,{default:Tt(()=>[(_(!0),S(R,null,F(u.value,i=>(_(),S(R,{key:i},[x(w(Bt),{index:i},null,8,["index"]),(_(!0),S(R,null,F(t.value[i],(n,r)=>(_(),j(w(wt),{key:r,title:n.NAME,onClick:m=>h(n)},null,8,["title","onClick"]))),128))],64))),128))]),_:1}))}});var Vt=_t(Dt,[["__scopeId","data-v-22e4b258"]]);export{Vt as default};
//# sourceMappingURL=CityChoose.76de3db5.js.map
